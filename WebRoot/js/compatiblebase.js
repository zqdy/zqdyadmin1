
(function(){lib._PAGE_EVENT.on("checkvip",function(){var a=lib.cookie.get("P01010");a&&(a=parseFloat(a)*1E3,a<=(new Date).getTime()&&lib.kit.util.jsLoad.request("http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php",{GET:{cb:"sendUserSign"},onSuccess:function(a){lib.log("\u53d1\u9001http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php\u6210\u529f\uff0c"+a)},onError:function(a){lib.log("\u53d1\u9001http://passport."+lib.SITE_DOMAIN+"/apis/user/userSign.php\u5931\u8d25\uff0c"+a)}}))})})();
lib.Class("Player",{ns:lib.kit,construct:function(a){this._player=document.getElementById(a.playerid);this._opt=a},methods:{_flashcall:function(a,b,c){lib.kit.FlashCall({flashID:this._opt.playerid,callback:c,functionName:a,parameter:b})},load:lib.emptyMethod,play:lib.emptyMethod,pause:lib.emptyMethod,seek:lib.emptyMethod,stop:lib.emptyMethod,getPlayInfo:lib.emptyMethod,getVideoInfo:lib.emptyMethod,on:lib.emptyMethod}});
(function(){lib.Class("HTML5Player",{ns:lib.kit,extend:lib.kit.Player,construct:function(a){this.callsuper(a);var b=b||{};this._definition="standard";this._playerstate="Playing";this._vid=b.videoId||"";this._tvid=b.tvId||"";this._pid=b.pid||"";this._ptype=b.ptype||"";this._aid=b.albumId||"";this._completeLoaded="false";this._player&&this._bindEvent()},methods:{_bindEvent:function(){var a=this;this._player.addEventListener("canplaythrough",function(){lib.log("canplaythrough");a._completeLoaded="true"});
this._player.addEventListener("timeupdate",function(){a._playStateChange("Playing")},!1);this._player.addEventListener("waiting",function(){lib.log("waiting");a._playStateChange("Waiting")},!1);this._player.addEventListener("pause",function(){lib.log("Paused");a._playStateChange("Paused")},!1);this._player.addEventListener("ended",function(){lib.log("Stoped");a._playStateChange("Stoped")},!1);this._player.addEventListener("seeking",function(){lib.log("Seeking");a._playStateChange("Seeking")},!1);
this._player.addEventListener("seeked",function(){lib.log("Seeked");a._playStateChange("Seeked")},!1);this._player.addEventListener("canplay",function(){lib.log("Ready");a._playStateChange("Ready")},!1);this._player.addEventListener("error",function(){lib.log("Failed");a._playStateChange("Failed")},!1)},load:function(a){lib.log("load");var b=this,a=a||{};if(a.preload!="true")this._vid=a.vid,this._tvid=a.tvId,this._pid=a.pid,this._ptype=a.ptype,this._aid=a.albumId,this._getm3u8(a,function(a){if(b._player)b._player.src=
a.url,b._player.load()})},play:function(){lib.log("play");this._player&&this._player.play()},pause:function(){this._player&&this._player.pause()},seek:function(a){lib.log("seek");if(this._player)this._player.currentTime=a},stop:function(){lib.log("stop")},getPlayInfo:function(a){var b={};b.vid=this._vid;b.tvid=this._tvid;b.currentTime=this._player.currentTime;b.totalDuration=this._player.duration;b.currentDefination=this._definition;b.currentTrack=this._player.audioTracks;b.currentStatus=this._playerstate;
b.uuid=lib.cookie.get("QC006");b.categoryId="";b.clientInstall="0";b.accInstall="0";a(b)},getVideoInfo:function(a){lib.kit.util.jsLoad.request("http://cache.video.qiyi.com/vj/",{CACHE:{tvid:this._tvid,vid:this._vid,varname:"tvInfoJs"},onSuccess:function(b){a(b)},onError:function(){}})},loadComplete:function(a){a()},on:function(a,b){lib._PAGE_EVENT.on("swf_playerStateChange",function(c){c=c||{};c.data=c.data||{};(c.data.state||"").toLocaleLowerCase()==a.toLocaleLowerCase()&&b(c.data)})},_getm3u8:function(a,
b){var c=this;lib.kit.util.jsLoad.request("http://cache.video.qiyi.com/m/",{CACHE:{vid:a.vid,varname:"ipadUrl"},onSuccess:function(a){b(a)},onError:function(){c._playStateChange("Failed")}})},_getmp4:function(a,b){lib.kit.util.jsLoad.request("http://127.0.0.1:1337/mp/",{CACHE:{vid:a.vid,varname:"test"},onSuccess:function(a){lib.kit.util.jsLoad.request(a.mp4,{GET:{cb:"videoUrl"},onSuccess:function(a){b(a)},onError:function(){}})},onError:function(){alert("\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")}})},
_playStateChange:function(a){lib.swf.notice('{"type":"playerStateChange","data":{"tvid":"'+this._tvid+'","state":"'+a.toLocaleLowerCase()+'"}}');this._playerstate=a}}})})();
(function(){lib.Class("QiyiHTML5Player",{ns:lib.kit,extend:lib.kit.HTML5Player,construct:function(a){this.callsuper(a)},methods:{setUserLogin:function(){lib.log("setUserLogin....")},setVisits:function(){},setLight:function(){lib.log("openLight.....")},setSubscribe:function(){lib.log("setSubscribe.....")},setNextVideoInfo:function(){lib.log("setNextVideoInfo.....")},setFullMoive:function(a){this._flashcall("setQiyiFullMoive",a)}}})})();
(function(){lib.Class("FlashPlayer",{ns:lib.kit,extend:lib.kit.Player,construct:function(a){this.callsuper(a);this._events={};this._fire()},methods:{load:function(a){lib.log("js call load");this._flashcall("loadQiyiVideo",a)},play:function(){this._flashcall("playQiyiVideo");lib.log("js call play")},pause:function(){this._flashcall("pauseQiyiVideo")},seek:function(a){this._flashcall("seekQiyiVideo",a)},stop:function(){lib.log("js call stop");this._flashcall("stopQiyiVideo")},getPlayInfo:function(a){this._flashcall("getQiyiPlayerInfo",
void 0,a)},getVideoInfo:function(a){this._flashcall("getQiyiVideoInfo",void 0,function(b){(b=(b=b||"")?JSON.parse(b.replace(/\r/g,"").replace(/\n/g,"")):"")&&a(b)})},loadComplete:function(a){this._flashcall("loadComplete",void 0,a)},on:function(a,b){lib.log("Register event : "+a);a=a.toLocaleLowerCase();a in this._events||(this._events[a]=[]);this._events[a].push(b)},_fire:function(){var a=this;lib._PAGE_EVENT.on("swf_playerStateChange",function(b){b=b||{};b.data=b.data||{};var c=b.data.state||"";
lib.log(c+"--player state--"+(new Date).getTime());lib.log("Player events : "+JSON.stringify(a._events));for(var d in a._events)if(d==c.toLocaleLowerCase())for(var e=a._events[d],f=0,g=e.length;f<g;f++)e[f](b.data)});lib._PAGE_EVENT.on("swf_recharge",function(b){b=b||{};b.data=b.data||{};b=b.data.code;lib.log("swf_recharge---"+(new Date).getTime());var c=a._events.recharge;if(c)for(var d=0,e=c.length;d<e;d++)c[d](b)})}}})})();
(function(){lib.Class("QiyiFlashPlayer",{ns:lib.kit,extend:lib.kit.FlashPlayer,construct:function(a){this.callsuper(a)},methods:{setUserLogin:function(a){this._flashcall("setQiyiUserLogin",a)},setVisits:function(a){lib.log("setVisits__"+a);this._flashcall("setQiyiVisits",a)},setLight:function(a){a==!0?lib.log("openLight....."):lib.log("closeLight.....");this._flashcall("setLight",a)},setSubscribe:function(a){lib.log("setSubscribe.....");this._flashcall("setQiyiSubscribe",a)},setNextVideoInfo:function(a){lib.log("setNextVideoInfo:"+
JSON.stringify(a));this._flashcall("setNextQiyiVideoInfo",a)},setFullMoive:function(a){this._flashcall("setQiyiFullMoive",a)},forceToSaveCurVideoInfo:function(a){lib.log("forceToSaveCurVideoInfo:"+JSON.stringify(a));this._flashcall("forceToSaveCurVideoInfo",a)},resumeVideo:function(a){lib.log("resumeQiyiVideo:"+JSON.stringify(a));this._flashcall("resumeQiyiVideo",a)},setContinuePlayState:function(a){lib.log("setContinuePlayState:"+JSON.stringify(a));this._flashcall("setContinuePlayState",a)},switchVideo:function(a){lib.log("switchVideo:"+
JSON.stringify(a));this._flashcall("switchVideo",a)},addVideoList:function(a){this._flashcall("addVideoList",a)},removeFromList:function(a){lib.log("removeFromList:"+JSON.stringify(a));this._flashcall("removeFromList",a)},revertFromList:function(a){lib.log("revertFromList:"+JSON.stringify(a));this._flashcall("revertFromList",a)}}})})();
(function(){lib.Class("QiyiPlayer",{ns:lib.kit,construct:function(a){var b=null;lib.ipad?(a.playerid="video",b=new lib.kit.QiyiHTML5Player(a)):b=new lib.kit.QiyiFlashPlayer(a);return b},statics:{_players:{},_playersID:lib.kit.video.getPlayersID()||[],getPlayer:function(a){a in lib.kit.QiyiPlayer._players||(lib.kit.QiyiPlayer._players[a]=new lib.kit.QiyiPlayer({playerid:a}));return lib.kit.QiyiPlayer._players[a]},hasPlayer:function(){return lib.kit.QiyiPlayer._playersID.length>0?!0:!1}}})})();
(function(){$reg("lib.ui",function(){});lib.ui.viewCenter=function(a,b){b=b||"absolute";if(a){var c=a.offsetWidth,d=a.offsetHeight,e=lib.box.getViewportWidth(),f=lib.box.getViewportHeight();if(!c||!d)throw"zero width or height.";c={left:(e-c)/2+lib.box.getPageScrollLeft(),top:(f-d)/2+lib.box.getPageScrollTop()};a.style.position=b;$(a).pos(c)}}})();
if(!window.JSON)window.JSON=window.JSON||{},JSON.parse=function(a){return(new Function("return "+a))()},JSON.stringify=function(){function a(a){/["\\\x00-\x1f]/.test(a)&&(a=a.replace(/["\\\x00-\x1f]/g,function(a){var b=c[a];if(b)return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)}));return'"'+a+'"'}function b(a){return a<10?"0"+a:a}var c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(c){switch(typeof c){case "undefined":return"undefined";
case "number":return isFinite(c)?String(c):"null";case "string":return a(c);case "boolean":return String(c);default:if(c===null)return"null";else if(c instanceof Array){var e=["["],f=c.length,g,h,i;for(h=0;h<f;h++)switch(i=c[h],typeof i){case "undefined":case "function":case "unknown":break;default:g&&e.push(","),e.push(JSON.stringify(i)),g=1}e.push("]");return e.join("")}else if(c instanceof Date)return'"'+c.getFullYear()+"-"+b(c.getMonth()+1)+"-"+b(c.getDate())+"T"+b(c.getHours())+":"+b(c.getMinutes())+
":"+b(c.getSeconds())+'"';else{g=["{"];f=JSON.stringify;for(key in c)if(c.hasOwnProperty(key))switch(h=c[key],typeof h){case "undefined":case "unknown":case "function":break;default:e&&g.push(","),e=1,g.push(f(key)+":"+f(h))}g.push("}");return g.join("")}}}}();
$reg("lib.kit.serverTime",function(){lib.kit.serverTime={serverUrl:"http://passport."+lib.SITE_DOMAIN+"/apis/external/time.php",init:function(a){var a=a||lib.emptyMethod,b=this;lib.kit.util.jsLoad.request(this.serverUrl,{GET:{cb:"cb_"+Math.ceil(Math.random()*1E5).toString(36)},onSuccess:function(c){b.serTime=parseInt(c.time,10);b.locTime=parseInt(new Date/1E3,10);a(b.serTime)},onError:function(){b.serTime=b.locTime=parseInt(new Date/1E3,10);a(b.serTime)},timeout:3E3})},now:function(a){if(!isNaN(this.serTime*
1)&&!isNaN(this.locTime*1)){var b=parseInt(new Date/1E3,10)-this.locTime*1+this.serTime*1;if(a instanceof Function)a(b);else return b}else this.init(a)}}});
(function(a,b,c){function d(a,c,d){lib.eventTarget.call(this);this.textInput=typeof a=="string"?b.getElementById(a):a;this.resultWrapper=null;this._dataApi=c;this.option=Object.extend(e,d);this._state=!1;this._timer=null;this.keyword=this.oldValue=this._query="";this._dataCache={};this._keySelecting=this._isnaving=!1;this._ifrCover=null}lib.html2Nodes=function(a){var c=b.createElement("div");c.innerHTML=a;return c.childNodes};var e={len:2,delayTime:200,isswfWrapper:!1,isJsSubmit:!0};(function(a,b){function c(){}
c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a})(d,lib.eventTarget);Object.extend(d.prototype,{_onBlur:function(){lib.log("sugest blur");this.stop()},_initTextInput:function(){var a=this;this.textInput.setAttribute("autocomplete","off");$(this.textInput).on("blur",this._onBlur.bind(this));$(this.textInput).on("keydown",function(b){b=lib.fixEvent(b);b=b.keyCode;b==27&&(a.stop(),a.close());if(b==40){if(a.isWrapperHidden())return;a._keySelecting=!0;a._state&&
a.stop();a.fire({type:"down"})}if(b==38){if(a.isWrapperHidden())return;a._keySelecting=!0;a._state&&a.stop();a.fire({type:"up"})}b==13&&(a.fire({type:"enter"}),a.option.isJsSubmit?(a.textInput.blur(),a._submitForm()):a._onBlur());if(b!=40&&b!=38)a._state||a.start(),a._keySelecting=!1})},init:function(){var a=this;this._initTextInput();this._initDom();this._initDataApi();this.initWinEvent();this.option.isswfWrapper&&($(b).on("click",function(b){b=lib.fixEvent(b);b.target!=a.textInput&&a.close()}),
$(b).on("keydown",function(b){b=lib.fixEvent(b);b.target!=a.textInput&&b.keyCode==9&&a.close()}))},_initDataApi:function(){var a=this;this._dataApi.on("receive",function(b){b.data&&b.data.length>0?a.open(a.cacheData(b.data,b.key)):(a.close(),(lib.ipad||lib.iphone)&&a.start(),a.fire({type:"empty"}))})},_initDom:function(){var a=this;this.resultWrapper=b.createElement("div");this.resultWrapper.style.width="0px";this.resultWrapper.style.height="0px";this.resultWrapper.style.position="absolute";this.resultWrapper.style.top=
"0px";this._hideWrapper();this.resultWrapper.style.visibility="hidden";b.body.appendChild(this.resultWrapper);$(this.resultWrapper).on("mouseover",function(){a._keySelecting=!0})},start:function(){this._state=!0;var a=this;this._timer=setTimeout(function(){a.upadteContent();a._timer=setTimeout(arguments.callee,a.option.delayTime)},this.option.delayTime)},stop:function(){this._state=!1;clearInterval(this._timer)},upadteContent:function(){var a=this._query=this.textInput.value;if(this.oldValue!==a)a.length<
this.option.len&&(this.stop(),this.close()),this._state&&this._dataCache[a]!==c&&!this._keySelecting?this.open(this._dataCache[a]):this._state&&a.length>=this.option.len&&!this._keySelecting&&this._dataApi.request(a),this.oldValue=a},cacheData:function(a,b){return this._dataCache[b]=a},open:function(a){var b=this;this.setPos();this.fire({type:"show",data:a});try{lib._PAGE_EVENT&&lib._PAGE_EVENT.on("rerender",function(){b._state=!0;b.setPos()})}catch(c){}},setText:function(a){this._keySelecting=!0;
this.textInput.value=this.keyword=a},setWrapperHtml:function(a){this.resultWrapper.innerHTML=a},reFocus:function(){this.textInput.focus();this.start()},setPos:function(){this.resultWrapper&&this._state&&this._setPos()},_setPos:function(){var a=lib.box.getPosition(this.textInput);this.resultWrapper.style.zIndex=1001;this.resultWrapper.style.width=this.textInput.offsetWidth+"px";this.resultWrapper.style.left=a.left+"px";this.resultWrapper.style.top=a.top+this.textInput.offsetHeight+"px";this.resultWrapper.style.visibility=
""},setEmpty:function(a){this.setWrapperHtml(a);this._setPos()},close:function(){this.fire({type:"close"});this.stop();this._hideWrapper()},_submitForm:function(){var a=this.textInput.form;if(a&&a.nodeName==="FORM"){var c=lib.Element.create("input");c.attr("type","hidden");c.attr("name","from");c.val("suggest");lib.$(a).append(c);b.createEvent?(c=b.createEvent("MouseEvents"),c.initEvent("submit",!0,!1),a.dispatchEvent(c)):b.createEventObject&&a.fireEvent("onsubmit")}},submitForm:function(){this._submitForm()},
iframeCover:function(){return lib.html2Nodes('<iframe border="0" frameBorder="0" style="display:none;" ></iframe>')[0]},initIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon)this._ifrCover=this.iframeCover(),b.body.appendChild(this._ifrCover)},coverIframe:function(a){var b=this._ifrCover.style;b.display="block";b.position="absolute";b.left=a.left+"px";b.top=a.top+"px";b.width=a.width+"px";b.height=a.height+"px";b.zIndex=999},showIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon){var a=$(this.resultWrapper).down("ul").box(),
b={};b.left=a.left;b.top=a.top;b.width=a.width;b.height=a.height;this.coverIframe(b)}},hideIfr:function(){if(lib.IE6||lib.IE7||lib.Maxthon)this._ifrCover.style.display="none"},reSizeWin:function(){this.setPos()},initWinEvent:function(){var b=this;lib.$(a).on("resize",function(){b.reSizeWin()})},_hideWrapper:function(){this.resultWrapper.style.visibility="hidden"},isWrapperHidden:function(){return this.resultWrapper.style.visibility=="hidden"},setWrapperCss:function(a){this.resultWrapper.style.cssText+=
";"+a}});a.lib=a.lib||{};lib.kit=lib.kit||{};lib.kit.suggest=d})(window,document);
$reg("lib.kit.UnderFrame",function(){lib.kit.UnderFrame={_frames:{},show:function(a,b){var c=lib.$("#"+a);if(c&&(b=b||{},!lib.ipad)){this._frames[a]||(this._frames[a]=lib.Element.create("iframe"),this._frames[a].attr("src","about:blank"),this._frames[a].attr("frameBorder","0"),this._frames[a].hide(),lib.$(document.body).append(this._frames[a]));var d=c.box();this._frames[a].css("position",b.position||"absolute");this._frames[a].css("zIndex",(b.zIndex||c.css("zIndex")-1).toString());this._frames[a].css("top",
(b.top||d.top)+"px");this._frames[a].css("left",(b.left||d.left)+"px");this._frames[a].css("width",(b.width||d.width)+"px");this._frames[a].css("height",(b.height||d.height)+"px");this._frames[a].css("opacity",b.opacity||0);this._frames[a].show()}},hide:function(a){lib.$("#"+a)&&this._frames[a]&&this._frames[a].hide()}}});
(function(){(function(a,b){function c(){lib.eventTarget.call(this);this._script=null;this.isDirect=0}function d(a){h.location=a}function e(a,b){if(!a)return null;return a.nodeName.toLowerCase()==b?a:e(a.parentNode,b)}function f(){lib.$("#j-suggestList")&&(lib.$("#j-suggestList").hide(),lib.kit.UnderFrame.hide("j-suggestList"))}var g=new lib.kit.Url(location.href),h=a;g.getParam("pr")=="baidu"&&(h=top);$reg("lib.action",function(){});$reg("lib.component",function(){});var i=a.document,j=i.getElementById("suggestText");
if(j){if(lib.IE6)lib._PAGE_EVENT.on("loginclose",function(){j&&j.focus();j&&j.blur()});c.inherits(lib.eventTarget);Object.extend(c.prototype,{request:function(b){var c="http://suggest.video."+lib.SITE_DOMAIN+"/suggest",d=lib.component.login.getUserInfo(),f=d&&d.uid,e=lib.cookie.get("QC006"),d=navigator.userAgent.toLowerCase(),g=/ipad/.test(d)?21:/iphone os/.test(d)?31:11;this.request=lib.IE&&!lib.IE9?function(b){var d=this,h=i.getElementsByTagName("head")[0],k=null,m=encodeURIComponent(b.trim().toLowerCase());
if(!this._script)k=i.createElement("script"),k.charset="utf-8",h.insertBefore(k,h.firstChild),this._script=k;this._script.onreadystatechange=function(){(!k||!k.readyState||!(k.readyState!="loaded"&&k.readyState!="complete"))&&a.suggestResult&&d.fire({type:"receive",data:suggestResult.data,key:b})};this._script.src=c+"?key="+m+"&cb=suggestResult&rltnum=10&uid="+e+"&ppuid="+f+"&platform="+g}:function(a){var b=this,d=a.trim().toLowerCase();lib.kit.util.jsLoad.request(c,{GET:{cb:"suggestResult",key:d,
rltnum:10,uid:e,ppuid:f,platform:g},onSuccess:function(c){b.fire({type:"receive",data:c,key:a})},onError:function(){lib.$("#j-suggestList").hide()}})};return this.request(b)}});lib.component.suggest=function(){this._first=!0;this._targetitem=0;this._eleSearch=j;this._dataRequest=new c;this._searchForm="j-search-form";this._suggestList="j-suggestList";this._submitBtn="searchClick";this._searchBg="j-search-bg";this._noValue="\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u8bcd\u2026";this.init=function(){this._cutRange=
parseInt(this._eleSearch.getAttribute("j-cutrange")||"18");this.form=$("#"+this._searchForm);this._suggest=new lib.kit.suggest(this._eleSearch,this._dataRequest,{len:1,isJsSubmit:!1,isswfWrapper:!0});this._suggest.init();this.initEvent()};this.initEvent=function(){var b=this;lib._PAGE_EVENT.on("suggest_event_focus",function(){var a=lib.$("#"+b._searchBg);a&&a.hasClass("srchDef")&&a.addClass("srchCur")});lib._PAGE_EVENT.on("suggest_event_blur",function(){var a=lib.$("#"+b._searchBg);a&&a.hasClass("srchDef")&&
a.removeClass("srchCur")});this._suggest.on("down",this._keyDown.bind(this,"down"));this._suggest.on("up",this._keyDown.bind(this,"up"));this._suggest.on("enter",this._keyDown_enter.bind(this));this._suggest.on("show",this._renderSuggest.bind(this));this._suggest.on("close",function(){lib.kit.UnderFrame.hide(b._suggestList)});this.form.on("submit",this._formSubmit.bind(this));var c=$("#"+this._submitBtn);if(c)c.on("click",function(c){c=a.event||c;lib.Event.stop(c);b._btnSubmitClick.call(b,c)});else lib.kit.slog.log({flag:"search",
url:location.href});var d=$(this._eleSearch);d.on("focus",function(){b._noValue==b._eleSearch.value.trim()&&d.val("");lib._PAGE_EVENT.fire({type:"suggest_event_focus"});d.css("color","")});lib.$(this._suggest.resultWrapper).on("click",this._mouseDown.bind(this))};this.close=function(){this._suggest.close()};this._btnSubmitClick=function(c){c=a.event||c;lib.Event.stop(c);lib._PAGE_EVENT.fire({type:"beforesearch",data:{keyword:this._eleSearch.value.trim()}});this._curr==-1||this._curr===b?this._eleSearch.value.trim()&&
this._eleSearch.value.trim()!=this._noValue?d(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value),"f_2"].join("_")+"?s="+new Date*1):(this._eleSearch.value=this._noValue,this._eleSearch.style.color="#a9a9a9",$("#"+this._submitBtn)[0].focus()):(c=this._result[this._curr].cname?"_ctg_"+encodeURIComponent(this._result[this._curr].cname):"",d(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value)+c,"f_1"].join("_")+"?s="+new Date*1))};this._formSubmit=
function(c){var f=this,c=a.event||c;lib.Event.stop(c);lib._PAGE_EVENT.fire({type:"beforesearch",data:{keyword:this._eleSearch.value.trim()}});var e=function(){if(this._result[this._curr]["j-alias"]||this._result[this._curr]["j-link"])d(this._result[this._curr]["j-firstLink"]?this._result[this._curr]["j-firstLink"]:this._result[this._curr]["j-link"]);else{var a=this._result[this._curr].cname?"_ctg_"+encodeURIComponent(this._result[this._curr].cname):"";d(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value)+
a,"f_1"].join("_")+"?s="+new Date*1)}};this._curr==-1||this._curr===b?this._eleSearch.value.trim()&&this._eleSearch.value.trim()!=this._noValue?d(["http://so."+lib.SITE_DOMAIN+"/so/q",encodeURIComponent(this._eleSearch.value),"f_2"].join("_")+"?s="+new Date*1):(this._eleSearch.value=this._noValue,this._eleSearch.style.color="#a9a9a9",$("#"+this._submitBtn)[0].focus()):this._result[this._curr].is_series?this._targetitem=="2"?d(this._result[this._curr]["j-link"]):lib.action.NewPlayHistory&&lib.action.NewPlayHistory.instance&&
lib.action.NewPlayHistory.instance.getAlbum?lib.action.NewPlayHistory.instance.getAlbum(this._result[this._curr].aid,function(a){a&&a.videoUrl?this._targetitem=="0"?d(a.videoUrl+"?key="+j.value+"&from=suggest&clicked=-"+a.videoName+"\u64ad\u653e\u8bb0\u5f55"):this._targetitem=="1"&&d(this._result[this._curr]["j-link"]):e.call(f)}.bind(this)):e.call(f):e.call(f)};this.submitLog=function(a){lib.log(a);lib.log(this.suggestAll);lib.log(this.level4cnt);lib.log(this.isDirect);lib.kit.slog.log({flag:"suggest",
suggestAll:this.suggestAll,level4cnt:this.level4cnt,level:a.level,keyword:a.name,isDirect:this.isDirect,cname:encodeURIComponent(a.cname)},"http://msg.video.qiyi.com/sev2.gif")};this._keyDown=function(a){var b=lib.$("#"+this._suggestList);if(b&&(b=b.down("a"),b.length>0))this._curr=a=="down"?this._curr+1>b.length-1?0:this._curr+1:this._curr-1<0?b.length-1:this._curr-1,this._setSelected(this._curr),this._suggest.setText(this._result[this._curr].name)};this._keyDown_enter=function(){this._curr&&this._curr!=
-1&&this.submitLog(this._result[this._curr])};this._mouseDown=function(b){var c=this,b=a.event||b;lib.Event.stop(b);var f=b.target||b.srcElement,f=e(f,"a");lib.$(f).attr("_index")!==null&&this._setSelected(parseInt(lib.$(f).attr("_index")));this._mouseDownEx(f);var g=function(){if(f.getAttribute("j-link")&&f.getAttribute("j-link")!=="")d(f.getAttribute("j-link"));else{var a=f.getElementsByTagName("span")[0],b=f.getAttribute("title");c._suggest.textInput.value=b!==""?b:a.innerHTML;a=f.getAttribute("j_ctg");
c._setChannelParam(a);c._suggest.submitForm()}};if(f.getAttribute("j-series"))if(this._targetitem=="2")d(this._result[this._curr]["j-link"]);else{lib.action.NewPlayHistory&&lib.action.NewPlayHistory.instance&&lib.action.NewPlayHistory.instance.getAlbum?lib.action.NewPlayHistory.instance.getAlbum(f.getAttribute("j-aid"),function(a){a&&a.videoUrl?this._targetitem=="0"?d(a.videoUrl+"?key="+j.value+"&from=suggest&clicked=-"+a.videoName+"\u64ad\u653e\u8bb0\u5f55"):this._targetitem=="1"&&d(f.getAttribute("j-link")):
g()}.bind(this)):g();return}g()};this._mouseDownEx=function(a){this.submitLog(this._result[a.getAttribute("_index")])};this._renderSuggest=function(b){lib._PAGE_EVENT.fire({type:"suggestShow"});var c=this,d={tv:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u5267\u96c6\u9875"},com:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u5267\u96c6\u9875"},"var":{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},tr:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},doc:{first:"\u6700\u65b0\u4e00\u671f",
suffix:"\u4e13\u9898"},art:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u4e13\u9898"},fasvar:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"}};this._curr=-1;this._result=b.data;var b=[],f=[];this.isDirect=0;this.suggestAll=this._result.length;for(var e=0;e<this._result.length;e++)if(this._result[e].level=="4"?f.push(this.getCurrentContext(e,d)):b.push(this.getCurrentContext(e,d)),e==0&&!this._result[0].added&&(this._result[0].recentLink!==""||this._result[0].firstLink!=="")&&this._addChildList(this._result[0].type),
this._result[e]["j-alias"])this.isDirect=1;this.level4cnt=f.length;var d=f.length>0?b.length>0?'<div style="border-top:1px solid #ccc; padding-top:5px; margin:5px 0;">'+f.join("")+"</div>":f.join(""):"",g=lib.$(this._suggest.resultWrapper).box().width;if(lib.$("*[data-newnav=newnav]")){var f=lib.$("#"+this._submitBtn),h=28,i=0;if(f)h=f.box().width,i=f.attr("_wsign")-0;this._suggest.resultWrapper.style.width=g+h+i-2+"px"}else if(g<200){f=lib.$("#"+this._submitBtn);h=28;i=0;if(f)h=f.box().width,i=f.attr("_wsign")-
0;this._suggest.resultWrapper.style.width=g+h+i+"px"}this._suggest.setWrapperHtml("<div id='"+this._suggestList+"' class='suggest_t' style='top:0px;left:0px;width:100%;'>"+b.join("")+d+"</div>");lib.kit.UnderFrame.show(this._suggestList);if(this._first)lib.$(a).on("resize",function(){if(lib.$(c._suggest.resultWrapper).css("visibility")!="hidden")this._suggest.resultWrapper.style.width=g+h+i+"px",lib.kit.UnderFrame.show(c._suggestList),lib.log("resize")}.bind(this)),this._first=!1};this.getCurrentContext=
function(a,b){var c=this._result[a],d=0,f=!!c["j-alias"],e=f?c["j-alias"]:c.name,g=[];if(f)g.push('<a href="#" '+(a===this._curr?'class="selected otherH"':'class="otherH"')+(c.is_series?'j-series="'+c.is_series+'" ':"")+(c.aid?'j-aid="'+c.aid+'" ':"")+' _index="'+a+'" j-link="'+c["j-link"]+'" style="cursor:pointer;" '+(c.cuted?'title="'+c.name+(b[c.type].suffix||"\u4e13\u9898")+'"':'title="'+c["j-alias"].slice(c["j-alias"].indexOf(c["j-alias"].match(/<*\/span>/))+7)+'"')+' j_ctg="'+c.cname+'">'),
g.push('<p _index="'+a+'" class="fL txtindex"><span _index="'+a+'" class="focus-item">'+e+"</span></p>");else{c.count=c.count?c.count+"":c.count;if(c.cname.length==2&&(d=e.getLen()>=(this._cutRange-1)*2?(this._cutRange-1)*2-2:0,c.type=="en"||c.type=="trail"||c.type=="level4"))d=e.getLen()>=(this._cutRange-2)*2?(this._cutRange-1)*2-2:0;c.cname.length==3&&(d=e.getLen()>=(this._cutRange-1)*2?(this._cutRange-1)*2-3:0);c.cname.length==4&&(d=e.getLen()>=(this._cutRange-2)*2?(this._cutRange-1)*2-3:0);c.cname||
(d=e.getLen()>=this._cutRange?this._cutRange*2:0);c.cname.length>4&&(d=(this._cutRange-2)*2-c.cname.length);f="";if(c.adInfo)f=' href="'+c.adLink+'" j-link="'+c.adLink+'" ',c["j-link"]=c.adLink;c.link&&(c["j-link"]=c.link+"?key="+j.value+"&from=suggest&clicked="+c.name);c.firstLink&&(c["j-firstLink"]=c.firstLink+"?key="+j.value+"&from=suggest&clicked=-"+c.name);g.push('<a href="#" '+(c.is_series?'j-series="'+c.is_series+'" ':"")+(c.aid?'j-aid="'+c.aid+'" ':"")+(c.firstLink&&(c.type=="tv"||c.type==
"com"||c.type=="doc")?'j-link="'+c["j-firstLink"]+'" ':c["j-link"]?'j-link="'+c["j-link"]+'" ':"")+(a===this._curr?'class="selected"':"")+f+' _index="'+a+'" style="cursor:default;" title="'+e+'" j_ctg="'+c.cname+'">');g.push('<p _index="'+a+'" class="fL"><span _index="'+a+'" style="float:left" class="focus-item">'+(d==0?e:e.trancate(d,".."))+"</span>"+(c.cname?'<span _index="'+a+'" style="float:left">('+(c.cname=="\u5a31\u4e50"?"\u5a31\u4e50":c.cname)+")</span>":"")+((c.type=="en"||c.type=="trail"||
c.type=="level4")&&c.link==""?'<span _index="'+a+'" style="float:right; padding-right:6px">'+c.count+"\u4e2a</span>":"")+"</p>")}g.push("</a>");return g.join("")};this._trancate=function(a){return a};this._addChildList=function(a){var b={tv:{first:"\u66f4\u65b0\u81f3",suffix:"\u5267\u96c6\u9875"},com:{first:"\u66f4\u65b0\u81f3",suffix:"\u5267\u96c6\u9875"},"var":{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},tr:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"},doc:{first:"\u6700\u65b0\u4e00\u671f",
suffix:"\u4e13\u9898"},art:{first:"\u6700\u65b0\u4e00\u96c6",suffix:"\u4e13\u9898"},fasvar:{first:"\u6700\u65b0\u4e00\u671f",suffix:"\u4e13\u9898"}};if(this._result[0].link!=""&&b[a]){this.isDirect=1;var c=this._cloneObject(this._result[0]),d=null,d=c.name,f=d.getLen()>=(this._cutRange-1)*2?(this._cutRange-1)*2-3:0;c["j-alias"]="<span class='linec'>-</span>"+(f==0?d:d.trancate(f,".."))+(b[a].suffix||"\u4e13\u9898");c["j-link"]=this._result[0].link+"?key="+j.value+"&from=suggest&clicked=-"+d+(b[a].suffix||
"\u4e13\u9898");c.cuted=f>0;this._result.splice(1,0,c);c=function(a){var b=[];if(a.type=="var"||a.type=="fasvar"){var c=parseInt(a.tvSeason,10),d=parseInt(a.tvPhase,10),f=parseInt(a.update,10);if(c||d||f)b.push("(\u7b2c"),d?c?b.push(c,"\u5b63 \u7b2c",d):b.push(d):b.push(function(a){a=a.match(/.{2}/g);return a[0]+a[1]+(a[2]?"-"+a[2]:"")+(a[3]?"-"+a[3]:"")}(a.update)),b.push("\u671f)")}else a.update&&b.push("(",a.update,")");return b.join("")}(this._result[0]);this._result[0].recentLink!==""&&(d=this._cloneObject(this._result[0]),
d["j-alias"]="<span class='linec'>-</span>"+b[a].first+c,d["j-link"]=this._result[0].recentLink+"?key="+j.value+"&from=suggest&clicked=-"+b[a].first+c,this._result.splice(1,0,d));this._result[0].recentLink===""&&this._result[0].firstLink!==""&&(d=this._cloneObject(this._result[0]),d["j-alias"]="<span class='linec'>-</span>\u89c2\u770b\u7b2c\u4e00\u96c6",d["j-link"]=this._result[0].firstLink+"?key="+j.value+"&from=suggest&clicked=-\u89c2\u770b\u7b2c\u4e00\u96c6",this._result.splice(1,0,d));this._result[0].added=
!0}};this._cloneObject=function(a){var b={};Object.extend(b,a);return b};this._setSelected=function(a){var b=i.getElementById(this._suggestList).getElementsByTagName("a");lib.$(b[this._targetitem]).removeClass("selected");this._targetitem=a;lib.$(b[a]).addClass("selected");this._curr=a};this._setChannelParam=function(a){var b=lib.Element.create("input");b.attr("type","hidden");b.attr("name","category");this.form.append(b);b.val(a)}};g=new lib.component.suggest;g.init();a.oldSuggest=g;lib._PAGE_EVENT.on("navOneShow",
f);lib._PAGE_EVENT.on("showUserPopup",f);lib._PAGE_EVENT.on("showPlayHistory",f);lib._PAGE_EVENT.on("showUpdateRecordFloater",f)}})(window)})();
(function(a){var b=$("#suggestText"),c="";b&&(c=b.attr("suggestWord")||"",$reg("lib.jobs.suggest",function(){var d=Object.extend(lib.jobs.suggest,{testDefault:function(){var d=b.val();return(d==c||!d)&&!(a.sManager&&sManager.oldKey==c)},setDefault:function(){b.val()==""&&(b.css("color","#a9a9a9"),b.val(c))}});b.on("focus",function(){d.testDefault()&&b.val("");b.css("color","");lib._PAGE_EVENT.fire({type:"suggest_event_focus"})}).on("blur",function(){lib._PAGE_EVENT.fire({type:"suggest_event_blur"});
d.testDefault()&&d.setDefault()});(new lib.kit.Url(a.location.href)).getParam("key")===""&&d.setDefault()}))})(window,document);
var webEventID,WebEventId=function(){this.callback=function(){};this.create=function(a){function b(){e++;d&&clearTimeout(d);!webEventID&&e<=50?d=setTimeout(b,100):e>50?c.getWebEventID():c.callback(webEventID)}this.callback=a||function(){};if(window.postWebEventID){var c=this,d,e=0;d=setTimeout(b,100)}else this.getWebEventID()};this.getWebEventID=function(){this._getFromServer()};this._getFromServer=function(){var a=this;lib.kit.util.jsLoad.request("http://data.video.qiyi.com/uid",{CACHE:{varname:"uid"},
onSuccess:function(b){b?(webEventID=b.uid,a.callback(webEventID)):a._getFromLocal()},onError:function(){a._getFromLocal()},is_timeout:!0,timeout:5E3})};this._getFromLocal=function(){for(var a=(new Date).getTime().toString(),b=String(Math.floor(999999999*Math.random()));b.length<9;)b="0"+b;webEventID=a.substr(a.length-10,10)+b;this.callback(webEventID)}};
$reg("lib.kit.Pager",function(){lib.kit.Pager=Class.create({initialize:function(a){this.opt=Object.extend({currentPage:1,showNum:10,totalNum:30,autoSelect:!0,onSelect:function(){},onClick:function(){},type:"view"},a);if(this.opt.showNum>this.opt.totalNum)this.opt.showNum=this.opt.totalNum;this.getDValue();if(this.opt.type=="view")this.box=a.box?$(a.box):$(document.body),this.initEvent();this.getPageList(this.opt.autoSelect)},reDraw:function(a){Object.extend(this.opt,a);if(this.opt.showNum>this.opt.totalNum)this.opt.showNum=
this.opt.totalNum;this.getDValue();this.getPageList(this.opt.autoSelect)},getDValue:function(){var a=this.opt.showNum;this.dValue=(a%2?a-1:a-2)/2},getPageList:function(a){this.pageInfo={up:!1,down:!1,dotup:!1,dotdown:!1,start:0,end:0};var b=Math.floor((this.opt.currentPage-1)/this.opt.showNum),c=b*this.opt.showNum,d=c+this.opt.showNum;this.pageInfo.up=this.opt.currentPage==1?!1:!0;this.pageInfo.down=this.opt.currentPage<this.opt.totalNum?!0:!1;this.opt.currentPage-this.dValue-1>0&&(c=this.opt.currentPage-
this.dValue-1>2?this.opt.currentPage-this.dValue-1:0,d=this.opt.currentPage+this.dValue>this.opt.totalNum?this.opt.totalNum:this.opt.currentPage+this.dValue);this.opt.currentPage==this.opt.totalNum&&(c=this.opt.totalNum-this.opt.showNum,c=c>2?c:0);b>0||c>2?(this.pageInfo.dotup=!0,this.pageInfo.dotdown=c+this.opt.showNum<this.opt.totalNum?!0:!1):this.pageInfo.dotdown=this.opt.showNum<this.opt.totalNum?!0:!1;c>2?this.pageInfo.dotup=!0:(c=0,this.pageInfo.dotup=!1);if(d>=this.opt.totalNum)this.pageInfo.dotdown=
!1;else if(d==this.opt.totalNum-1)d=this.opt.totalNum,this.pageInfo.dotdown=!1;this.pageInfo.start=c;this.pageInfo.end=d;if(a!=!1)this.opt.onSelect(this.opt.currentPage);this.opt.type=="view"&&this.drawList()},drawList:function(){var a=[];this.pageInfo.up?a.push('<a href="#" title="\u8df3\u8f6c\u81f3'+(this.opt.currentPage-1)+'\u9875" class="a1" data-key="up" >\u4e0a\u4e00\u9875</a>'):a.push('<span class="noPage">\u4e0a\u4e00\u9875</span>');this.pageInfo.dotup&&(a.push('<a href="#" title="\u8df3\u8f6c\u81f3\u7b2c\u4e00\u9875" data-key="1">1</a>'),
a.push('<a href="#" data-key="dotup">...</a>'));for(var b=this.pageInfo.start;b<this.pageInfo.end;b++){var c=b+1;c==this.opt.currentPage?a.push('<span class="curPage" data-key="'+c+'">'+c+"</span>"):a.push('<a href="#" title="\u8df3\u8f6c\u81f3\u7b2c'+c+'\u9875" data-key="'+c+'">'+c+"</a>")}this.pageInfo.dotdown&&(a.push('<a href="#" data-key="dotdown">...</a>'),a.push('<a href="#" title="\u8df3\u8f6c\u81f3\u7b2c\u6700\u540e\u4e00\u9875" data-key="'+this.opt.totalNum+'" >'+this.opt.totalNum+"</a>"));
this.pageInfo.down?a.push('<a href="#" title="\u8df3\u8f6c\u81f3'+(this.opt.currentPage+1)+'\u9875" class="a1" data-key="down">\u4e0b\u4e00\u9875</a>'):a.push('<span class="noPage">\u4e0b\u4e00\u9875</span>');this.box.html(a.join(" "))},initEvent:function(){this._clickevent=this.onPageClick.bindEvent(this);this.box.on("click",this._clickevent)},removeEvent:function(){this._clickevent&&this.box.un("click",this._clickevent)},forward:function(){if(this.opt.currentPage){this.opt.currentPage-=1;if(this.opt.currentPage<
1)return!1;this.getPageList();return!0}return!1},next:function(){if(this.opt.currentPage){this.opt.currentPage+=1;if(this.opt.currentPage>this.opt.totalNum)return!1;this.getPageList();return!0}return!1},selectByIndex:function(a){this.opt.currentPage=a;this.getPageList()},selectByItem:function(a){if(a=a.getAttribute("data-key"))if(a=="up")this.forward(),this.opt.onClick(this.opt.currentPage);else if(a=="down")this.next(),this.opt.onClick(this.opt.currentPage);else if(a!="dot")this.opt.currentPage=
a=="dotup"?this.pageInfo.start-1:a=="dotdown"?this.pageInfo.end+1:parseInt(a),this.opt.onClick(this.opt.currentPage),this.getPageList()},onPageClick:function(a){lib.Event.stop(a);a=a.srcElement||a.target;a.tagName.toLowerCase()=="a"&&this.selectByItem(a)}});lib.kit.Pager.init=function(a){return new lib.kit.Pager(a)}});
$reg("lib.kit.Draggable",function(){lib.kit.Draggable=Class.create({initialize:function(a){this.options=Object.extend({handle:null,helper:"original",containment:!1,element:null,onDrag:null,onStop:null,onStart:null},a);(this.element=$(this.options.element))&&this._mouseInit()},_mouseInit:function(){var a=this;this._mouseDownDelegate=function(b){a._mouseDown(b)};lib.Event.on(this.element[0],"mousedown",this._mouseDownDelegate);a.handle=$(this.options.handle,this.element[0]);a.handle.css("cursor","move")},
_mouseDown:function(a){var b=this;if(!a.target)a.target=a.srcElement||document;if(!a.which&&a.button!==void 0)a.which=a.button&1?1:a.button&2?3:a.button&4?2:0;b._mouseStarted&&b._mouseUp(a);b._mouseDownEvent=a;if(a.which!=1||!b._getHandle(a))return!0;b._mouseStarted=b._mouseStart(a)!==!1;if(!b._mouseStarted)return lib.Event.preventDefault(a),!0;b._mouseMoveDelegate=function(a){return b._mouseMove(a)};b._mouseUpDelegate=function(a){return b._mouseUp(a)};lib.Event.on(document,"mousemove",b._mouseMoveDelegate).on(document,
"mouseup",b._mouseUpDelegate);lib.Event.preventDefault(a);return!0},_mouseUp:function(a){lib.Event.un(document,"mousemove",this._mouseMoveDelegate);lib.Event.un(document,"mouseup",this._mouseUpDelegate);if(this._mouseStarted)this._mouseStarted=!1,this._mouseStop(a);return!1},_getHandle:function(a){var b=this.handle;if(!b)return!1;a=a.target;for(b=b[0];a&&a.nodeType!==9;){if(a==b)return!0;a=a.parentNode}return!1},_mouseStart:function(a){var b=this.options.onStart;if(a.pageX==null&&a.clientX!=null){var c=
document.documentElement,d=document.body;a.pageX=a.clientX+(c&&c.scrollLeft||d&&d.scrollLeft||0)-(c&&c.clientLeft||d&&d.clientLeft||0);a.pageY=a.clientY+(c&&c.scrollTop||d&&d.scrollTop||0)-(c&&c.clientTop||d&&d.clientTop||0)}this.helper=this._createHelper(a);this._cacheHelperProportions();this._cacheMargins();this.offset=this.element.pos();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};Object.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-
this.offset.top},parent:this._getParentOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;if(b&&b.call(this.element[0],a)===!1)return this._mouseUp({}),!1;this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";return!0},_getParentOffset:function(){this.offsetParent=$(this.helper[0].offsetParent);var a=this.offsetParent.pos();if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
this.offsetParent[0].tagName.toLowerCase()=="html"&&lib.IE)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_mouseMove:function(a){if(lib.IE&&!a.button)return this._mouseUp(a);if(this._mouseStarted)return this._mouseDrag(a),lib.Event.preventDefault(a);(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==!1)?this._mouseDrag(a):this._mouseUp(a);return!this._mouseStarted},_mouseStop:function(a){var b=
this.options.onStop;b&&b.call(this.element[0],a)!==!1&&this._clear();return!1},_createHelper:function(){return this.element},_cacheHelperProportions:function(){var a=this.helper.box;this.helperProportions={width:a.width,height:a.height}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_generatePosition:function(a){if(a.pageX==null&&a.clientX!=null){var b=document.documentElement,c=document.body;a.pageX=
a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b&&b.clientLeft||c&&c.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&c.clientTop||0)}var b=a.pageX,c=a.pageY,d=this.options.containment;d&&(a.pageX-this.offset.click.left<d[0]&&(b=d[0]+this.offset.click.left),a.pageY-this.offset.click.top<d[1]&&(c=d[1]+this.offset.click.top),a.pageX-this.offset.click.left>d[2]&&(b=d[2]+this.offset.click.left),a.pageY-this.offset.click.top>d[3]&&(c=d[3]+this.offset.click.top));
return{top:c-this.offset.click.top-this.offset.parent.top,left:b-this.offset.click.left-this.offset.parent.left}},_mouseDrag:function(a){this.position=this._generatePosition(a);var b=this.options.onDrag;if(b&&b.call(this.element[0],a)===!1)return this._mouseUp(a),!1;this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";return!1},_clear:function(){var a=this.helper[0];a!=this.element[0]&&!this.cancelHelperRemoval&&a.parentNode.removeChild(a);this.helper=
null;this.cancelHelperRemoval=!1},destroy:function(){if(this.element.hasClass("j-draggable"))return this.element.removeClass("j-draggable"),this.handle.css("cursor",""),this._mouseDestroy(),this},_mouseDestroy:function(){lib.Event.un(this.element[0],"mousedown",this._mouseDownDelegate)}})});
$reg("lib.kit.Dialog",function(){lib.kit.Dialog=function(a){lib.eventTarget.call(this);this.options=Object.extend({autoOpen:!0,content:"",contentSelector:"",modal:!0,context:window},a);this.options.contextDoc=this.options.context.document;this._create()};lib.kit.Dialog.inherits(lib.eventTarget);Object.extend(lib.kit.Dialog.prototype,{template:'<div style="display: none;width:${width}px;"class="j-dialog j-widget-content j-corner-all ${dialogClass}" tabindex="-1"><div class="j-dialog-titlebar j-widget-header j-corner-all j-helper-clearfix" unselectable="on"style="-moz-user-select: none;"><span class="j-dialog-title" unselectable="on" style="-moz-user-select: none;">${title}</span><a href="#" class="j-dialog-close j-corner-all" unselectable="on" style="-moz-user-select: none;"><span class="j-icon j-icon-closethick" unselectable="on" style="-moz-user-select: none;"></span></a></div><div class="j-dialog-content j-widget-content"></div><div class="j-dialog-buttonpane j-widget-content j-helper-clearfix"></div></div>',
buttonTemplate:new lib.Template('<a href="#" class="inputBtn2" onclick="return false;">${text}</a>'),_create:function(){var a=this,b=a.options,c,d,e=b.content,f=b.contentSelector;$(b.contextDoc.body).append(c=a.uiDialog=$(lib.Element.create("div").html((new lib.Template(b.template||a.template)).evaluate(b))[0].firstChild).css("position","absolute").css("zIndex",b.zIndex||100).on("keydown",function(c){b.closeOnEscape!==!1&&c.keyCode&&c.keyCode===27&&(a.close(c),lib.Event.preventDefault(c))}));d=a.content=
c.down(".j-dialog-content");f?d.append($(f)):typeof e=="string"?d.html(e):d.append($(e));(d=c.down(".j-dialog-close"))&&d.on("click",function(b){a.close(b);return!1});a.uiDialogTitlebar=c.down(".j-dialog-titlebar");b.draggable!==!1&&lib.kit.Draggable&&a._makeDraggable();b.buttons&&a._createButtons(b.buttons);this.onResize();a._isOpen=!1;b.modal||lib.kit.BgIframe.create(c);this.options.autoOpen&&this.open()},onResize:function(a){var b=this,a=a||{};lib.Event.on(this.options.context||window,"resize",
b.onResize=function(){b._setPos(a.pos)})},_createButtons:function(a){var b=this,c=b.options,d=!1,e=b.uiDialog,f=e[0];b.uiDialogButtonPane=e.down(".j-dialog-buttonpane");typeof a==="object"&&a!==null&&lib.each(a,function(){return!(d=!0)});if(d)(e=b.uiDialogButtonPane.down("*"))&&e.remove(),a.constructor==Object&&(a=[a]),b.buttons=[],lib.each(a,function(a){var d=$(lib.Element.create("div").html((c.buttonTemplate||b.buttonTemplate).evaluate(a))[0].firstChild).on("click",function(c){var d=a.fn;d&&d.constructor==
Function&&d.apply(f,arguments);a.close&&b.close(c)});b.buttons.push(d);b.uiDialogButtonPane.append(d)}),b._initButtonEvents()},open:function(){if(!this._isOpen){var a=this.options,b=this.uiDialog;this.overlay=a.modal?lib.kit.Overlay.create({context:a.context,zIndex:a.coverzIndex}):null;b.show();this._isOpen=!0;this._setPos(a.pos);(this.buttons||b)[0].focus();a.onOpen&&a.onOpen.apply(b[0]);return this}},close:function(a){if(this._isOpen){var b=this.options,c=b.onBeforeClose,d=b.onClose,e=this.uiDialog[0];
if(!(c&&!1===c.call(e,a)))return this.overlay&&lib.kit.Overlay.destroy(this.overlay),this._isOpen=!1,b.destroyOnClose!==!1?this.destroy():this.uiDialog.hide(),d&&d.call(e,a),this.release&&this.release(),this}},setContent:function(a){this.content.html(a)},_setPos:function(a){if(this._isOpen){var b,c=this.uiDialog,d=c.box();if(a&&a.top)b=a.top;else{b=d.height==0?180:d.height;var e=lib.box.getViewportHeight(this.options.context),f=lib.box.getPageScrollTop(this.options.context);b=b<e-30?(e-b)/2+f:f+30}a&&
a.left?a=a.left:(a=d.width==0?180:d.width,a=(lib.box.getViewportWidth(this.options.context)-a)/2);c.css("top",b+"px");c.css("left",a+"px");lib.kit.BgIframe.setBox(c);return this}},isOpen:function(){return this._isOpen},destroy:function(){this.overlay&&lib.kit.Overlay.destroy(this.overlay);lib.Event.un(this.options.context||window,"resize",this.onResize);this.options.contextDoc.body.removeChild(this.uiDialog[0]);return this},_makeDraggable:function(){var a=this.options,b=this.uiDialog,c=b[0],d=a.onDragStart,
e=a.onDrag,f=a.onDragStop;if(a=this.uiDialogTitlebar)this.draggable=new lib.kit.Draggable({element:b,handle:a,onStart:function(a){if(typeof d=="function")return d.call(c,a)},onDrag:function(a){if(typeof e=="function")return e.call(c,a)},onStop:function(a){lib.kit.Overlay.resize();if(typeof f=="function")return f.call(c,a)}}),b.addClass("j-draggable")},widget:function(){return this.uiDialog},option:function(a,b){var c=a,d=this;if(arguments.length===0)return Object.extend({},d.options);if(typeof a===
"string"){if(b===void 0)return this.options[a];c={};c[a]=b}lib.each(c,function(a,b){d._setOption(b,a)});return d},_setOption:function(a,b){var c=this.uiDialog;switch(a){case "buttons":this._createButtons(b);break;case "dialogClass":c.removeClass(this.options.dialogClass).addClass(b);break;case "draggable":b?this._makeDraggable():this.draggable.destroy();break;case "position":a="pos";this._setPos(b);break;case "title":$(".j-dialog-title",this.uiDialogTitlebar[0]).html(""+(b||"&#160;"))}this.options[a]=
b},setPos:function(a,b){this._setOption("position",{top:a,left:b})},release:null})});
$reg("lib.kit.SimpleDialog",function(){lib.kit.SimpleDialog=function(a){lib.kit.Dialog.call(this,Object.extend({delegates:["ok","no"]},a))};lib.kit.SimpleDialog.inherits(lib.kit.Dialog);Object.extend(lib.kit.SimpleDialog.prototype,{_create:function(){var a=this.options;$(a.contextDoc.body).append(this.content=this.uiDialog=lib.Element.create("div").html(a.content).css("position","absolute").css("zIndex",a.zIndex||"111"));this.onResize();this._addDelegates();a.autoOpen&&this.open()},_setDelegates:function(a){if(a==
"")return this.options.delegates;this.options.delegates=a.match(/j\-delegate\=[\'|\"](.*?)[\'|\"]/gi).map(function(a){return a.match(/[\'|\"](.*?)[\'|\"]/)[1]})},_addDelegates:function(){var a=0,b=this.options.delegates,c=b.length;this.listDlg=[];for(var d=null;a<c;a++)d=this._cbdlg.bind(this,b[a]),this.listDlg.push(d),$(this.uiDialog).delegate(b[a],d)},_removeDelegates:function(){if(this.listDlg){for(var a=0,b=this.options.delegates,c=b.length,d=null;a<c;a++)d=this.listDlg[a],$(this.uiDialog).undelegate(b[a],
d);delete this.listDlg}},_cbdlg:function(a,b){this.fire({type:a,event:b.event})},show:function(a){this.setContent(a);this.open()},release:function(){this._removeDelegates()}})});
$reg("lib.kit.Overlay",function(){lib.kit.Overlay={options:null,instances:[],oldInstances:[],create:function(a){this.options=a=Object.extend({color:"#666666",opacity:50,context:window},a||{});var b=a.context.document;if(this.instances.length===0)lib.Event.on(a.context,"resize",this.resize);var c=a.opacity,a=(this.oldInstances.pop()||lib.Element.create("div",null,a.context).css("position","fixed").css("top","0px").css("left","0px")).css("width",this._getWidth()).css("height",this._getHeight()).css("backgroundColor",
a.color).css("filter","alpha(opacity="+c+")").css("opacity",c/100).css("zIndex",a.zIndex||10);lib.IE6&&a.css("position","absolute");$(b.body).append(a);lib.kit.BgIframe.create(a);this.instances.push(a);return a},resize:function(){var a=lib.kit.Overlay;lib.each(a.instances,function(b){b.css("width",0).css("height",0).css("width",a._getWidth()).css("height",a._getHeight());lib.kit.BgIframe.setBox(b)})},_getWidth:function(){var a=this.options.context.document,b;if(lib.IE6)return b=Math.max(a.documentElement.scrollWidth,
a.body.scrollWidth),a=Math.max(a.documentElement.offsetWidth,a.body.offsetWidth),b<a?lib.box.getViewportWidth(this.options.context)+"px":b+"px";else{if(lib.IE7||lib.IE8)return Math.max(a.documentElement.clientWidth,a.body.scrollWidth,a.documentElement.scrollWidth,a.body.offsetWidth)-1+"px";return Math.max(a.documentElement.clientWidth,a.body.scrollWidth,a.documentElement.scrollWidth,a.body.offsetWidth,a.documentElement.offsetWidth)+"px"}},_getHeight:function(){var a=this.options.context.document,
b;return lib.IE6?(b=Math.max(a.documentElement.scrollHeight,a.body.scrollHeight),a=Math.max(a.documentElement.offsetHeight,a.body.offsetHeight),b<a?lib.box.getViewportHeight(this.options.context)+"px":b+"px"):lib.box.getDocumentHeight(this.options.context)+"px"},destroy:function(a){var b=this.options.context;this.oldInstances.push(this.instances.splice(this.instances.index(a),1)[0]);this.instances.length===0&&lib.Event.un(b,"resize",this.resize);a=a[0];(b=a.parentNode)&&b.removeChild(a)}}});
$reg("lib.kit.BgIframe",function(){lib.kit.BgIframe={create:function(a){if(!lib.WEBKIT&&(lib.IE6||lib.Maxthon))a=$(a),a.down("iframe.bgiframe")||this.setBox(a.append(lib.Element.create('<iframe class="bgiframe"frameborder="0" tabindex="-1"src="javascript:false;"style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');top:0px;left:0px;"/>')))},setBox:function(a){var a=$(a),b=a.down("iframe.bgiframe");if(b){var c=a.box();lib.each(["width","height"],function(a){b.css(a,c[a]+"px")})}}}});
(function(a){var b=!1,c=null,d,e,f,g,h,i,j;lib.component.HeaderPopup={init:function(){var b=this;(new lib.kit.Monitor(function(){d=lib.$("#j-username");e=lib.$("#j-user-popup");f=lib.$("#j-header");if(!d||!e||!f)return!1;d.on("click",b._clickHandler.bind(b));$(a).on("resize",b._pos.bind(b));lib.ipad||(d.on("mouseover",b._userOver.bind(b)),d.on("mouseout",b._userOut.bind(b)),e.on("mouseover",b._popupOver.bind(b)),e.on("mouseout",b._popupOut.bind(b)))},{time:100})).start()},destroy:function(){d&&(d.un("click",
this._clickHandler.bind(this)),d.un("mouseover",this._userOver.bind(this)),d.un("mouseout",this._userOut.bind(this)),e.un("mouseover",this._popupOver.bind(this)),e.un("mouseout",this._popupOut.bind(this)))},_show:function(){e.show();this._pos()},_pos:function(){g=d.box();h=f.box();j=g.left+g.width;lib.$("*[data-newnav=newnav]")?(i=g.top,e.css("top",i+29+"px"),e.css("left",j-e.box().width+20+"px")):(i=h.top+h.height,e.css("top",i+"px"),e.css("left",j-e.box().width+21+"px"));lib.kit.UnderFrame.show("j-user-popup");
lib._PAGE_EVENT.fire({type:"showUserPopup"})},_hide:function(){e.hide();lib.kit.UnderFrame.hide("j-user-popup")},_clickHandler:function(a){lib.Event.preventDefault(a);lib.ipad&&(b?(this._hide(),b=!1,lib.action.ipadPlayer&&lib.action.ipadPlayer.showVideo()):(this._show(),b=!0,lib.action.ipadPlayer&&lib.action.ipadPlayer.hideVideo()))},_userOver:function(){c!==null&&clearTimeout(c);b!==!0&&(this._show(),b=!0)},_userOut:function(){var a=this;b===!0&&(c=setTimeout(function(){a._hide();b=!1},100))},_popupOver:function(){c!==
null&&clearTimeout(c)},_popupOut:function(){var a=this;b===!0&&(c=setTimeout(function(){a._hide();b=!1},100))}}})(window);lib.model.userState=lib.model({crossDomain:!0,actions:{get:{method:"get",params:["cid","platform"],format:"json",encode:!0,passport:!0,url:"qv.action"}},url:"http://serv.vip."+lib.SITE_DOMAIN+"/services/"});
$reg("lib.action.UserState",function(){lib.action.UserState=Class.create({initialize:function(){},isVip:function(a){var b=window.qiyueChannelId,c="11",c=lib.realIpad?"21":lib.iphone?"31":"11";lib.model.userState.get(b?{cid:b,platform:c}:void 0,{success:function(b){a.success&&a.success(b)},failure:function(b){a.failure&&a.failure(b)}})}})});
(function(){lib.component.login={};$reg("lib.component",function(){});$reg("lib.__callbacks__",function(){});$reg("lib.tpl",function(){});Object.extend(lib.component.login,{renderTopbar:function(){this.isLogin()&&this._checkVip()},removeUserMenu:function(){var a=$("#j-user-popup");a&&a.remove()},_checkVip:function(){if(lib.action&&lib.action.UserState){var a=this;(new lib.action.UserState).isVip({success:function(b){(a.vipCB||function(){}).call(this,b);a.vipInfo=b;a.isExpire=!1;lib._PAGE_EVENT.fire({type:"checkvip"})},
failure:function(b){(a.notVipCB||function(){}).call(this);b.code=="Q00324"?(a.isExpire=!0,a.vipInfo=b.data):a.vipInfo=!1;lib._PAGE_EVENT.fire({type:"checkvip"})}})}}})})(window);lib.reg("lib.model",function(){});lib.Class("Model",{ns:lib.model,properties:{_data:{}},construct:function(){this._data={}},methods:{init:lib.emptyMethod,get:function(){return this._data},set:function(a){return Object.extend(this._data,a)}}});lib.reg("lib.view",function(){});
lib.Class("View",{ns:lib.view,methods:{init:lib.abstractMethod,update:lib.abstractMethod}});
(function(){lib.Class("Adapter",{ns:lib.action,construct:function(a,b){if(a instanceof lib.model.Model)this._model=a,this._model.init(this);if(b instanceof lib.view.View)this._view=b,this._view.init(this)},methods:{syncGet:function(a){if(this._model)var b=this._model.get(a);this._view&&this._view.update(b)},asyncGet:function(a){if(!this._model)return!1;var b=this;this._model.get(a,function(a){b._view&&b._view.update(a)})},syncSet:function(a){if(this._model)var b=this._model.set(a);this._view&&this._view.update(b)},
asyncSet:function(a){if(!this._model)return!1;var b=this;this._model.set(a,function(a){b._view&&b._view.update(a)})}}})})();
(function(){lib.Class("WmodeSp",{ns:lib.kit,extend:lib.action.Adapter,construct:function(){this.videostatus="visible"},methods:{show:function(){if(!lib.ipad&&!lib.IE&&this.check())this.videostatus="hidden",this.videoplayer.css("visibility","hidden")},hide:function(){!lib.ipad&&!lib.IE&&this.videostatus=="hidden"&&this.videoplayer&&this.videoplayer.attr("player_display_state")!="none"&&this.videoplayer.css("visibility","visible")},check:function(){if(this.videoplayer=lib.$("#flash")){var a=navigator.appVersion.toLowerCase().indexOf("win")!=
-1?!0:!1,b="",c;try{c=this.videoplayer[0].tagName.toLocaleLowerCase()}catch(d){}if(c=="embed")lib.IE&&a&&!lib.OPERA?this.videoplayer[0].wmode&&(b=this.videoplayer[0].wmode.toLocaleLowerCase()=="direct"||this.videoplayer[0].wmode.toLocaleLowerCase()=="window"):this.videoplayer.attr("wmode")&&(b=this.videoplayer.attr("wmode").toLocaleLowerCase()=="direct"||this.videoplayer.attr("wmode").toLocaleLowerCase()=="window");else if(c=="object")try{this.videoplayer.children().each(function(a){a.attr("name").toLocaleLowerCase()==
"wmode"&&(b=a.attr("value").toLocaleLowerCase())})}catch(e){}return this.videoplayer&&b?!0:!1}else return!1}}});lib._PLAYER_WMODE_SP=new lib.kit.WmodeSp})();
(function(a){a.kit=a.kit||{};kit.dialog=function(a){lib.eventTarget.call(this);this._option={model:!0,delegates:["ok","no"]};this.setOption(a)};kit.dialog.inherits(lib.eventTarget);Object.extend(kit.dialog.prototype,{show:function(a){lib.ipad||lib._PLAYER_WMODE_SP&&lib._PLAYER_WMODE_SP.show();if(this._option.model&&!this._cover)this._cover=lib.kit.Overlay.create({color:"#000",zIndex:400});this.box||(a.html?this.renderHTML(a.html):(a.src&&this.renderIfr(a),this.fire({type:"show"})))},setOption:function(a){Object.extend(this._option,
a||{})},renderHTML:function(a){var c=this._tempId="j-"+(new Date).getTime();$(document.body).html("beforeend","<div id="+c+">"+a+"</div>");this.box=$("#"+c)[0].firstChild;this._addDelegates()},_addDelegates:function(){var a=0,c=this._option.delegates,d=c.length;this.listDlg=[];for(var e=null;a<d;a++)e=this._cbdlg.bind(this,c[a]),this.listDlg.push(e),$(this.box).delegate(c[a],e)},_removeDelegates:function(){if(this.listDlg){for(var a=0,c=this._option.delegates,d=c.length,e=null;a<d;a++)e=this.listDlg[a],
$(this.box).undelegate(c[a],e);this.listDlg=null}},_cbdlg:function(a){this.fire({type:a})},setCenter:function(){lib.ui.viewCenter(this.box)},renderIfr:function(b){var c={src:"about:blank",width:580,height:375},d=document.getElementById("j-dialog"),e=this._tempId="j-"+(new Date).getTime();$(document.body).html("beforeend","<div id="+e+"></div>");Object.extend(c,b);d?(d.width=c.width,d.height=c.height,d.src=c.src):($(document.body).html("beforeend",'<iframe allowtransparency="true" id="j-dialog" src="'+
c.src+'" frameborder="0" scrolling="no" width="'+c.width+'" height="'+c.height+'" style="z-index:9999;"></iframe>'),d=document.getElementById("j-dialog"));this.box=d;lib.ui.viewCenter(this.box);this.__setCenter=this.setCenter.bind(this);var f=this;(lib.IE6||lib.IE7)&&lib._PAGE_EVENT&&lib._PAGE_EVENT.on("rerender",function(){if(lib.$("#j-dialog")&&f._cover)lib.$("#j-dialog")[0].style.display="block",lib.$("#j-dialog")[0].style.display=""});$(a).on("resize",this.__setCenter);if(lib.IE6)$(a).on("scroll",
this.__setCenter)},hide:function(){this.box.hide();this._cover&&lib.kit.Overlay.destroy(this._cover);this._cover=null},close:function(b){lib.ipad||lib._PLAYER_WMODE_SP&&lib._PLAYER_WMODE_SP.hide();lib._PAGE_EVENT&&lib._PAGE_EVENT.fire({type:"loginclose",data:b?{btnId:b}:{}});if(b=document.getElementById(""+this._tempId))this._cover&&lib.kit.Overlay.destroy(this._cover),$(this.box).remove(),this._removeDelegates(),this.fire({type:"close"}),this._cover=this.box=null,b&&$(b).remove(),this.__setCenter&&
$(a).un("resize",this.__setCenter),lib.IE6&&$(a).un("scroll",this.__setCenter)}})})(window);















lib.action.btnState=function(a){var b=lib.$("#flash")&&lib.$("#flash")[0].getCategoryId&&lib.$("#flash")[0].getCategoryId();b&&lib.kit.slog.log({type:"endpagebtn",act:a,cid:b},"http://msg.video.qiyi.com/tmpstats.gif");var c=lib.$("#flash")&&lib.$("#flash")[0].getQiyiPlayerInfo&&lib.$("#flash")[0].getQiyiPlayerInfo();c&&(JSON.parse(c)||{}).categoryId&&lib.kit.slog.log({type:"endpagebtn",act:a,cid:b},"http://msg.video.qiyi.com/tmpstats.gif")};
lib.kit.newJob("downYingyin",function(){lib.$(document).delegate("downYingyin",function(a){var b=lib.$(a.target),a=b.attr("data-downpos"),b=b.attr("data-downtype");lib.kit.slog.log({downpos:a,downtype:b},"http://msg.video.qiyi.com/tmpstats.gif")})});lib._PAGE_JOB.add("downYingyin");
(function(){lib.Class("StaticAdapter",{ns:lib.action,extend:lib.action.Adapter,construct:function(a,b){this.callsuper(a,b)},methods:{init:function(a){var a=a||{},b={},c=this._view.getInfo();Object.extend(b,a);Object.extend(b,c);this._model.set(b);this.syncGet()}}})})();
(function(){lib.Class("Slide",{ns:lib.action,extend:lib.action.StaticAdapter,construct:function(a,b){this.callsuper(a,b)},methods:{prev:function(){this._model.prev();this.syncGet()},next:function(){this._model.next();this.syncGet()},moveToFocus:function(a){this._model.moveToFocus(a);this.syncGet()},changeTotal:function(a){this._model.changeTotal(a);this.syncGet()}}})})();
(function(){lib.Class("VideoUnderSlide",{ns:lib.action,extend:lib.action.Slide,construct:function(a,b){this.callsuper(a,b)},methods:{init:function(a){var b=this;this._model.getData(this._view.getParam(a.cid),function(c){b._view.initRender(c,a.container)});this.autoPlayNext();lib._PAGE_EVENT.on("videounder_playdone",function(){b.flag=!1})},autoPlayNext:function(){var a=this;this.time=setTimeout(function(){clearTimeout(a.time);a.flag||a.next();a.time=setTimeout(arguments.callee,5500)},5500)},prev:function(){this.flag=
!0;this._model.prev();this.syncGet()},next:function(){this.flag=!0;this._model.next();this.syncGet()},moveToFocus:function(a){this._model.moveToFocus(a);this.syncGet()},changeTotal:function(a){this._model.changeTotal(a);this.syncGet()}}})})();
(function(){lib.Class("SlideModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this._data={first:1,focus:1,total:0,disp:0}},methods:{prev:function(){this._data.first=this._data.disp>1?Math.max(this._data.first-(this._data.disp-1),1):Math.max(this._data.first-1,1)},next:function(){if(this._data.disp>1){if(this._data.total>this._data.disp)this._data.first=Math.min(this._data.first+(this._data.disp-1),this._data.total-this._data.disp+1)}else this._data.first=Math.min(this._data.first+1,
this._data.total)},moveToFocus:function(a){this._data.focus=a;this._data.first=Math.max(1,Math.min(this._data.focus-Math.floor(this._data.disp/2),this._data.total-this._data.disp+1))},changeTotal:function(a){this._data.total=a;if(this._data.disp>1){if(this._data.total>this._data.disp)this._data.first=Math.min(this._data.first,this._data.total-this._data.disp+1)}else this._data.first=Math.min(this._data.first,this._data.total)}}})})();
(function(){lib.Class("SetGroupTabContModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this._geturl="http://top.inter.qiyi.com/index/front"},methods:{get:function(a,b){a=a||{};a.area="top";Object.extend(a,{cb:"tab"+(new Date).getTime(),time:(new Date).getTime()});var c=this;lib.kit.util.jsLoad.request(this._geturl,{GET:a,onSuccess:function(d){d._param={};Object.extend(d._param,a);c._data=d;b(c._data)},onError:function(a){b(a.data)}})}}})})();
(function(){lib.Class("VideoUnderSlideModel",{ns:lib.model,extend:lib.model.SlideModel,construct:function(a){this.callsuper();this.model=a&&a.model||new lib.model.SetGroupTabContModel;this._data.disp=a&&a.disp||4},methods:{getData:function(a,b){var c=this;this.model.get(a,function(a){c._data.total=Math.ceil(a.length/2);b({content:a,data:c._data})})},prev:function(){this._data.first-=this._data.disp>1?this._data.disp:1;this._data.first<1&&(this._data.first=this._data.total-this._data.disp+1)},next:function(){this._data.first+=
this._data.disp>1?this._data.disp:1;this._data.first>this._data.total&&(this._data.first=1)}}})})();(function(){lib.Class("StaticView",{ns:lib.view,extend:lib.view.View,methods:{getInfo:lib.abstractMethod}})})();
$reg("lib.ui.Anim",function(){var a={Linear:function(a,c,d,e){return d*a/e+c},Quad:{easeIn:function(a,c,d,e){return d*(a/=e)*a+c},easeOut:function(a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOut:function(a,c,d,e){if((a/=e/2)<1)return d/2*a*a+c;return-d/2*(--a*(a-2)-1)+c}},Cubic:{easeIn:function(a,c,d,e){return d*(a/=e)*a*a+c},easeOut:function(a,c,d,e){return d*((a=a/e-1)*a*a+1)+c},easeInOut:function(a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a+c;return d/2*((a-=2)*a*a+2)+c}},Quart:{easeIn:function(a,c,d,e){return d*
(a/=e)*a*a*a+c},easeOut:function(a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOut:function(a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+c;return-d/2*((a-=2)*a*a*a-2)+c}},Quint:{easeIn:function(a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOut:function(a,c,d,e){return d*((a=a/e-1)*a*a*a*a+1)+c},easeInOut:function(a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+c;return d/2*((a-=2)*a*a*a*a+2)+c}},Sine:{easeIn:function(a,c,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+c},easeOut:function(a,c,d,e){return d*Math.sin(a/
e*(Math.PI/2))+c},easeInOut:function(a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c}},Expo:{easeIn:function(a,c,d,e){return a==0?c:d*Math.pow(2,10*(a/e-1))+c},easeOut:function(a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOut:function(a,c,d,e){if(a==0)return c;if(a==e)return c+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+c;return d/2*(-Math.pow(2,-10*--a)+2)+c}},Circ:{easeIn:function(a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+c},easeOut:function(a,c,d,e){return d*Math.sqrt(1-(a=
a/e-1)*a)+c},easeInOut:function(a,c,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+c;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+c}},Elastic:{easeIn:function(a,c,d,e,f,g){if(a==0)return c;if((a/=e)==1)return c+d;g||(g=e*0.3);!f||f<Math.abs(d)?(f=d,d=g/4):d=g/(2*Math.PI)*Math.asin(d/f);return-(f*Math.pow(2,10*(a-=1))*Math.sin((a*e-d)*2*Math.PI/g))+c},easeOut:function(a,c,d,e,f,g){if(a==0)return c;if((a/=e)==1)return c+d;g||(g=e*0.3);if(!f||f<Math.abs(d))var f=d,h=g/4;else h=g/(2*Math.PI)*Math.asin(d/
f);return f*Math.pow(2,-10*a)*Math.sin((a*e-h)*2*Math.PI/g)+d+c},easeInOut:function(a,c,d,e,f,g){if(a==0)return c;if((a/=e/2)==2)return c+d;g||(g=e*0.3*1.5);if(!f||f<Math.abs(d))var f=d,h=g/4;else h=g/(2*Math.PI)*Math.asin(d/f);if(a<1)return-0.5*f*Math.pow(2,10*(a-=1))*Math.sin((a*e-h)*2*Math.PI/g)+c;return f*Math.pow(2,-10*(a-=1))*Math.sin((a*e-h)*2*Math.PI/g)*0.5+d+c}},Back:{easeIn:function(a,c,d,e,f){f==void 0&&(f=1.70158);return d*(a/=e)*a*((f+1)*a-f)+c},easeOut:function(a,c,d,e,f){f==void 0&&
(f=1.70158);return d*((a=a/e-1)*a*((f+1)*a+f)+1)+c},easeInOut:function(a,c,d,e,f){f==void 0&&(f=1.70158);if((a/=e/2)<1)return d/2*a*a*(((f*=1.525)+1)*a-f)+c;return d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+c}},Bounce:{easeIn:function(b,c,d,e){return d-a.Bounce.easeOut(e-b,0,d,e)+c},easeOut:function(a,c,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+c},easeInOut:function(b,c,d,e){return b<
e/2?a.Bounce.easeIn(b*2,0,d,e)*0.5+c:a.Bounce.easeOut(b*2-e,0,d,e)*0.5+d*0.5+c}}};lib.ui._anim=Class.create({initialize:function(a){this.opt=Object.extend({duration:1E3,onStart:function(){},onDone:function(){},onCompute:function(){},interval:10,ease:"",el:null},a||{});this.ease();this.counter=0;this.el=this.opt.el?$(this.opt.el):null;this.info={}},getAnim:function(a,c,d){for(var e=[],f=0;f<a;f++)e.push(this.tweenFunc(f,c,d,a));return e},getAnimInfo:function(){this.interval=this.opt.duration/this.opt.interval;
for(var a in this.info){if(this.info[a].from==void 0)this.info[a].from=this.getDefaultFrom(this.el,a);this.info[a].unit=a=="opacity"?"":"px";this.info[a].animArray=this.getAnim(this.interval,this.info[a].from,this.info[a].to-this.info[a].from)}},getDefaultFrom:function(a,c){if(c=="scroll")return lib.box.getPageScrollTop();return parseInt(a.css(c))||0},onCompute:function(){for(var a in this.info)a=="scroll"?window.scrollTo(0,this.info[a].animArray[this.counter]):this.el.css(a,this.info[a].animArray[this.counter]+
this.info[a].unit);this.counter++},compute:function(){this.counter>=this.interval?(clearTimeout(this.iTimer),this.done(),this.counter=0):(this.onCompute(),this.iTimer=setTimeout(function(){this.compute()}.bind(this),this.opt.interval))},ease:function(b){if(!b)return this.tweenFunc=a.Linear,this;b=b.split(".");this.tweenFunc=b.length!=2?a.Linear:a[b[0]][b[1]];return this},duration:function(a){this.opt.duration=a;return this},delay:function(a){this.opt.interval=a;return this},done:function(){for(var a in this.info)a==
"scroll"?window.scrollTo(0,this.info[a].to):this.el.css(a,this.info[a].to+this.info[a].unit);if(this.opt.onDone)this.opt.onDone();this.info={}},from:function(a,c){this.info[a]||(this.info[a]={});this.info[a].from=c;return this},to:function(a,c){this.info[a]||(this.info[a]={});this.info[a].to=c;return this},scrollTo:function(a){this.info.scroll||(this.info.scroll={});this.info.scroll.to=a;return this},go:function(){this.getAnimInfo();this.inAnim=!0;this.iTimer&&clearTimeout(this.iTimer);this.compute();
return this},stop:function(){this.pause();this.counter=0},pause:function(){this.inAnim&&clearTimeout(this.iTimer);this.getAnimInfo()},resume:function(){this.compute()},onDone:function(a){this.opt.onDone=a;return this}});lib.ui.Anim=function(a){return new lib.ui._anim({el:a})}});
(function(){lib.Class("SlideView",{ns:lib.view,extend:lib.view.StaticView,properties:{itemWidth:127,lBtnId:"j-arrowL",rBtnId:"j-arrowR",wrapperId:"j-allList",itemTag:"li",lNoneClass:"arrayLNone",rNoneClass:"arrayRNone",animEffact:"Expo.easeOut",animTime:500,animDir:"left",selectedClass:"selected",disp:7,_start:0},construct:function(a){a=a||{};Object.extend(this,a)},methods:{init:function(a){if(a)this._ctrl=a;this._initDom();this._initWrapperWidth();this._initEvent()},_initDom:function(){this._btnLeft=
lib.$("#"+this.lBtnId);this._btnRight=lib.$("#"+this.rBtnId);this._allList=lib.$("#"+this.wrapperId);this._list=this._allList.down(this.itemTag);var a=lib.$(this._list[0]);this.itemWidth=a.box().width+parseInt(a.css("marginLeft"))+parseInt(a.css("marginRight"))},_initWrapperWidth:function(){this._allList.css("width",this.itemWidth*this._list.length+20+"px")},update:function(a){lib.log("update");this._setBtnStatus(a);a.total>1&&this._playAnim(a);this._recurItem(a)},_setBtnStatus:function(a){a.first==
1?this._btnLeft.addClass(this.lNoneClass):this._btnLeft.removeClass(this.lNoneClass);a.first+a.disp-1==a.total||a.total<=a.disp?this._btnRight.addClass(this.rNoneClass):this._btnRight.removeClass(this.rNoneClass)},_playAnim:function(a){this._end=this.itemWidth*(1-a.first);this._anim=lib.ui.Anim("#"+this._allList.attr("id"));this._anim.duration(this.animTime);this._anim.ease(this.animEffact);var b=this;b._beforeAnim(a);lib.log("from "+this._start+" to "+this._end);this._anim.from(this.animDir,this._start).to(this.animDir,
this._end).go().onDone(function(){b._afterAnim(a)});this._start=this._end},_beforeAnim:function(){},_afterAnim:function(){},_recurItem:function(a){for(var b=0;b<this._list.length;b++){var c=lib.$(this._list[b]);this._checkItem(c)&&(this._setFocus(c,b,a),this._loadImg(c,b,a))}},_checkItem:function(){return!0},_setFocus:function(a,b,c){var d=lib.$(a.down("img")[0]),e=lib.$(a.down("span")[0]),f=lib.$(a.down("a")[1]),a=lib.$(a.down("a")[0]);b===c.focus-1?(d.addClass(this.selectedClass),f.addClass(this.selectedClass),
a.attr("class","imgBg1"),e.show()):(d.removeClass(this.selectedClass),f.removeClass(this.selectedClass),a.attr("class",""),e.hide())},_loadImg:function(a,b,c){var a=lib.$(a.down("img")[0]),d=a.attr("data-lazyload")||a.attr("data-lazy");if(b>=c.first-1&&b<c.first-1+c.disp&&d){a.attr("src",d);try{a.removeAttr("data-lazyload"),a.removeAttr("data-lazy")}catch(e){}}},getInfo:function(){var a=this.checkFocus(),b=1,c=this._list.length,b=Math.max(1,Math.min(a-3,c-this.disp+1));return{focus:a,total:c,disp:this.disp,
first:b}},checkFocus:function(){for(var a=1,b=0;b<this._list.length;b++)this._isFocus(lib.$(this._list[b]))&&(a=b+1);return a},_isFocus:function(){return!1},_initEvent:function(){this._bindSlideEvent();this._bindMouseEvent()},_bindSlideEvent:function(){var a=this;this._btnLeft.on("click",function(b){lib.Event.stop(b);a._btnLeft.hasClass(a.lNoneClass)||a._ctrl.prev()});this._btnRight.on("click",function(b){lib.Event.stop(b);a._btnRight.hasClass(a.rNoneClass)||a._ctrl.next()})},_bindMouseEvent:function(){}}})})();
(function(){lib.Class("VideoUnderSlideView",{ns:lib.view,extend:lib.view.SlideView,construct:function(a){a=a||{};Object.extend(this,a);this.shownum=8;this._tpl_view='<li><a href="${album_play_url}"><img alt="${album_name}" src="$img{album_pic_url,_116_65}"></a><p class="bt"><a href="${album_play_url}">${album_name}</a></p></li>'},methods:{init:function(a){this._ctrl=a},initRender:function(a){for(var b=new lib.TemplateNew(this._tpl_view),c=[],d=0,e=a.content.length;d<e;d++)c.push(b.evaluate(a.content[d]));
(b=lib.$("#"+this.wrapperId))&&b.html(c.join(""));this.callsuper("init",this._ctrl);this.update(a.data)},_afterAnim:function(){lib._PAGE_EVENT.fire({type:"videounder_playdone"})},getInfo:function(){var a=lib.$("#"+this.wrapperId);a&&a.box().width();return{shownum:8}},_initWrapperWidth:function(){this._allList.css("width",this.itemWidth*this._list.length/2+20+"px")},_setFocus:function(){},_setBtnStatus:function(){},getParam:function(a){return{dim:"wee",len:40,cid:a}}}})})();
(function(){lib.kit.newJob("videoUnderSlide",function(){lib._PAGE_EVENT.on("videoUnder",function(a){var b=a.target.data.container;if(b){b.html('<div class="limitCont"><div class="limitHd"><h2>\u5f88\u62b1\u6b49\uff0c\u7531\u4e8e\u7248\u6743\u5230\u671f\u60a8\u6240\u89c2\u770b\u7684\u89c6\u9891\u5df2\u7ecf\u4e0b\u7ebf</h2></div><div class="split"></div><div class="limitMid"><p class="vdoHot">\u8fd9\u4e9b\u89c6\u9891\u6700\u8fd1\u5f88\u706b\uff0c\u8d76\u7d27\u770b\u770b\u5427</p><div id="j-videounder-left" class="btnlt"><a href=""></a></div><div style="overflow:hidden;position:relative;" class="rightCont"><ul style="position: relative; height: 268px; width: 2840px; left: -1692px;" id="j-videounder-wrapper" class="limitList"></ul></div><div id="j-videounder-right" class="btnrt"><a href=""></a></div></div></div>');
var b=new lib.model.VideoUnderSlideModel,c=new lib.view.VideoUnderSlideView({wrapperId:"j-videounder-wrapper",itemWidth:116,lBtnId:"j-videounder-left",rBtnId:"j-videounder-right"});(new lib.action.VideoUnderSlide(b,c)).init(a.target.data)}})});lib._PAGE_JOB.add("videoUnderSlide")})();
(function(){lib.kit.newJob("androidCannotPlay",function(){var a=new lib.action.Floater,b=!1;lib.cookie.get("QAF")!="1"&&(a.show({html:'<div class="unionTg"><div class="downDesc"><h3><span class="icon"></span>\u4e0b\u8f7d\u5947\u827a\u5f71\u89c6\u5ba2\u6237\u7aef\uff0c\u968f\u65f6\u968f\u5730\u60a6\u4eab\u5947\u827a\u9ad8\u6e05\u89c6\u9891</h3><div class="tips" id="j-donotshow"><em class="" id="j-donotshowcbx"></em>\u4e0d\u518d\u63d0\u9192</div></div><div class="sayAfter"><a href="#" id="acpLater" class="say">\u7a0d\u540e\u518d\u8bf4</a><a href="http://app.iqiyi.com/mobile/player/index.html#mobile" class="down">\u7acb\u5373\u4e0b\u8f7d</a></div></div>'}),lib.$("#acpLater").on("click",
function(){b==!0&&lib.cookie.set("QAF","1",365,"/",lib.SITEDOMAIN);a.destroy()}),lib.$("#j-donotshow").on("click",function(){var a=lib.$("#j-donotshowcbx");a.attr("class")=="selected"?(a.attr("class",""),b=!1):(a.attr("class","selected"),b=!0)}))});lib.noFlashAndroid&&!lib.html5Video&&lib._PAGE_JOB.add("androidCannotPlay")})();(function(){lib.Class("PlayerPageTopFloat",{ns:lib.action,extend:lib.action.Adapter,construct:function(a,b){this.callsuper(a,b)},methods:{}})})();
(function(){lib.Class("PlayerPageTopFloaterView",{ns:lib.view,extend:lib.view.FloaterView,methods:{showCover:function(){},hideCover:function(){},showPlayer:function(){},hidePlayer:function(){},init:function(a){this._ctrl=a;this._elem=lib.Element.create("div");lib.IE6&&this._elem.css("position","absolute");this._elem.css("zIndex","100");this._elem.css("overflow","hidden");this._elem.css("visibility","hidden");lib.$(document.body).append(this._elem)},build:function(a){if(a.isReDisplay)return!1;this.callsuper("build",
a)},adjustPosition:function(){this._srcPos={top:0,left:0};this._elem.pos(this._srcPos)},changePosition:function(a,b){this._srcPos={top:b,left:a};this._elem.pos(this._srcPos)},show:function(){if(lib.ff)this.callsuper("show");else{this._anim?this._anim.stop():(this._anim=lib.ui.Anim(this._elem),this._anim.duration(100));this._elem.css("opacity","0");this.callsuper("show");this._anim.from("opacity",0).to("opacity",1).go().onDone(function(){});this._fAnim?this._fAnim.stop():(this._fAnim=lib.ui.Anim(this._elem.first()),
this._fAnim.duration(100));var a=this;this._fAnim.from("width",0).to("width",lib.box.getViewportWidth()).go().onDone(function(){a._elem.first().css("width",lib.box.getViewportWidth())});this._fAnim.from("height",0).to("height",71).go()}},hide:function(a){if(lib.ff)this.callsuper("hide");else{this._anim?this._anim.stop():(this._anim=lib.ui.Anim(this._elem),this._anim.duration(100));var b=this;this._anim.from("opacity",this._elem.css("opacity")).to("opacity",0).go().onDone(function(){arguments.callee._construct=
b.hide._construct;b.callsuper("hide");a&&a.apply(b)})}},destroy:function(){if(lib.ff)this.callsuper("destroy");else{var a=this;this.hide(function(){arguments.callee._construct=a.destroy._construct;this.callsuper("destroy")})}}}})})();
(function(){lib.Class("PlayerPageTopFloatView",{ns:lib.view,extend:lib.view.View,construct:function(){},properties:{_registerBtn:lib.$("a[j-pingbackbtntype='register']"),_loginBtn:lib.$("a[j-pingbackbtntype='login']")},methods:{init:function(a){this._ctrl=a;this.bindEvent();this.initScroll()},update:function(){},initScroll:function(){if(!lib.component.login.isLogin())this._doWindowScroll=this.doWindowScroll.bind(this),this._doWindowResize=this.doWindowResize.bind(this),lib.$(window).on("scroll",this._doWindowScroll),
lib.$(window).on("resize",this._doWindowResize)},bindEvent:function(){lib._PAGE_EVENT.on("login",this.doLogin.bind(this));lib._PAGE_EVENT.on("logout",this.doLogout.bind(this));this._registerBtn&&this._registerBtn.on("click",this.doClickRegisterBtn.bind(this));this._loginBtn&&this._loginBtn.on("click",this.doClickLoginBtn.bind(this))},doLogin:function(){if(lib.component.login.isLogin()){try{lib.$(window).un("scroll",this._doWindowScroll),lib.$(window).un("resize",this._doWindowResize)}catch(a){}this.hideFloater();
lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"loginsuc",weid:window.webEventID,ppuid:lib.component.login.getUserInfo().uid},"http://msg.video.qiyi.com/tmpstats.gif")}},doLogout:function(){this.initScroll()},doClickRegisterBtn:function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"clreg",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")},
doClickLoginBtn:function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"cllogin",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")},doWindowScroll:function(){lib.box.getPageScrollTop()>140?this.showFloater():this.hideFloater();lib.IE6&&this.floaterView&&this.floaterView.changePosition(0,lib.box.getPageScrollTop())},doWindowResize:function(){lib.box.getPageScrollTop()>140&&(this.showFloater(!0),lib.IE6&&this.floaterView&&
this.floaterView.changePosition(0,lib.box.getPageScrollTop()))},initFloater:function(){var a=['<div id="playertopfloat" class="login_guidance_new" style="position:fixed;z-index:99999;left:0;top:0;width:100%;overflow:hidden;"><div class="bd"><h2><a href="javascript:" title="" style="cursor:default;"></a></h2><div class="login_guiText"><p>\u767b\u5f55\u540e\u6c38\u4e45\u4fdd\u5b58\u64ad\u653e\u8bb0\u5f55\uff0c\u53ef\u63d0\u4f9b\u4e2a\u6027\u5316\u5185\u5bb9\u63a8\u8350<a class="regT" id="j-playerpagefloatlogin" href="javascript:" href="javascript:">\u767b\u5f55</a><a class="regT" id="j-playerpagefloatregest" target="_blank" href="http://passport.qiyi.com/register/reg.php?url=">\u6ce8\u518c</a></p><div class="ft">',
'<p class="hzLog"><a id="j-weibologin" href="http://passport.'+lib.SITE_DOMAIN+'/oauth/login.php?isiframe=1&type=2" j-delegate="oauth" class="weiboIcoNew"></a><a id="j-qqlogin" href="http://passport.'+lib.SITE_DOMAIN+'/oauth/login.php?isiframe=1&type=4" j-delegate="oauth" class="qqIcoNew"></a></p>','</div></div><div class="log_guiRnew"><div class="hd">',this.checkShouCang()?'<p>\u5efa\u8bae\u60a8\u7acb\u5373 <a id="j-float-favourite" href="javascript:" title="\u6536\u85cf\u672c\u7ad9">\u6536\u85cf\u672c\u7ad9</a>':
"\u3000",lib.ipad||lib.iphone||lib.ipod?"":"<p>\u81ea\u7531\u89c2\u770b\u9ad8\u6e05\u6b63\u7248\u70ed\u95e8\u89c6\u9891</p>","</div></div></div></div>"].join("");this.floaterView=new lib.view.PlayerPageTopFloaterView;var b=new lib.action.Floater(new lib.model.FloaterModel,this.floaterView);b.show({html:a});this.bindFavourite();this.bindFloatBtn();this.floater=b},bindFloatBtn:function(){lib.$("#j-playerpagefloatlogin").on("click",function(a){lib.Event.stop(a);lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",
jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"cllogin",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif");if(lib.component.login.isLogin())return lib.component.login.runCallbacks("login"),!1;lib.component.login.showOnce(function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"loginsuc",weid:window.webEventID,ppuid:lib.component.login.getUserInfo().uid},"http://msg.video.qiyi.com/tmpstats.gif")})});
lib.$("#j-playerpagefloatregest").on("click",function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"clreg",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")});lib.$("#j-weibologin").on("click",function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"weiboclcooplog",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")});lib.$("#j-qqlogin").on("click",
function(){lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"qqclcooplog",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")})},showFloater:function(a){if(this.floater){if(!this.floater.isOpen()||a)this.floater.show({isReDisplay:!0}),lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,jsact:"show",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif")}else this.initFloater();
lib.IE6||lib.kit.UnderFrame.show("playertopfloat",{position:"fixed",top:"0",left:"0",height:"69",width:lib.box.getViewportWidth()})},checkShouCang:function(){var a=window.external,b=window.sidebar;return/se \d\.x/.test(navigator.userAgent.toLowerCase())||lib.Maxthon||!lib.CHROME&&!lib.IE7&&(a||b)},bindFavourite:function(){var a=lib.$("#j-float-favourite");a&&a.on("click",this.doFavourite.bind(this))},doFavourite:function(){var a="http://www."+lib.SITE_DOMAIN||window.curVideoURL||location.href,b=window.external,
c=window.sidebar;lib.action.PlayerTrialFloater.pingback({type:"baidupopdiv",jsuid:lib.cookie.get("QC006"),qtcurl:location.href,usract:"clfav",weid:window.webEventID},"http://msg.video.qiyi.com/tmpstats.gif");c?c.addPanel("\u7231\u5947\u827a-\u4e2d\u56fd\u7b2c\u4e00\u5f71\u89c6\u95e8\u6237 \u9ad8\u6e05\u5f71\u89c6\u5267\u3001\u7f51\u7edc\u89c6\u9891\u5728\u7ebf\u89c2\u770b",a,""):b&&("addFavorite"in b?b.addFavorite(a,"\u7231\u5947\u827a-\u4e2d\u56fd\u7b2c\u4e00\u5f71\u89c6\u95e8\u6237 \u9ad8\u6e05\u5f71\u89c6\u5267\u3001\u7f51\u7edc\u89c6\u9891\u5728\u7ebf\u89c2\u770b"):
"AddFavorite"in b&&b.AddFavorite(a,"\u7231\u5947\u827a-\u4e2d\u56fd\u7b2c\u4e00\u5f71\u89c6\u95e8\u6237 \u9ad8\u6e05\u5f71\u89c6\u5267\u3001\u7f51\u7edc\u89c6\u9891\u5728\u7ebf\u89c2\u770b"))},hideFloater:function(){if(this.floater&&this.floater.isOpen()){var a=this;if(this.destroyTimer)clearTimeout(this.destroyTimer),this.destroyTimer=null;this.destroyTimer=setTimeout(function(){a.floater.hide();lib.kit.UnderFrame.hide("playertopfloat");a.destroyTimer=null},50)}}}})})();
(function(){lib.kit.newJob("playerpagetopfloat",function(){var a=new lib.view.PlayerPageTopFloatView,b=new lib.model.Model;new lib.action.PlayerPageTopFloat(b,a)});lib._PAGE_JOB.add("playerpagetopfloat")})();var Tween={};

(function(){var a=["iPadAdResource","iPadAdResource_1"],b={};a.each(function(a){b[a]=lib.$("[data-widget="+a.toLowerCase()+"]")});lib.kit.newJob("iPadAdResource",function(){a.each(function(a){var d="";if(lib.temp[a]&&lib.temp[a].resources){var e=lib.temp[a].resources.length;if(e){b[a].css("display")=="none"&&b[a].css("display","");for(var f=0;f<e;f++){var g=lib.temp[a].resources[f];g.display=f==0?"block":"none";var h=new lib.Template(g.tpl);d+=h.evaluate(g)}b[a].html(d);if(e>1){var i=1;setInterval(function(){var d=
b[a].down("[data-elem=ipadaditem]");d.hide();i%=e;lib.$(d[i]).show();i++},lib.temp[a].interval)}}}})});a.filter(function(a){return lib.temp[a]&&b[a]}).length&&lib._PAGE_JOB.add("iPadAdResource")})();(function(){lib.kit.newJob("iframeNavOpenNewWin",function(){if(top!==self&&document.referrer.indexOf("video.baidu.com")>-1){var a=document.createElement("base");a.target="_blank";document.getElementsByTagName("head")[0].appendChild(a)}});lib._PAGE_JOB.add("iframeNavOpenNewWin")})();
(function(){lib._PAGE_JOB.add("yingyin",{albumId:info.albumId,title:info.title,isCharge:"false",tvid:info.tvId,check:function(){var a=lib.action.ClearSwf.get();return a&&a.hasInstallPlayer&&a.hasInstallPlayer()?!0:lib.action.YingyinPlugin?lib.action.YingyinPlugin.check():!1},pageType:"end"})})();
lib.Class("HTML5Controlbar",{ns:lib.kit,construct:function(a){this.callsuper(a);this.srcWaitTimeId=this.movePos=this.starPos=null},methods:{init:function(){var a=this;this.first=!0;this._video=lib.$("#video");this.warpper=lib.$("#j-html5video-warrper");if(this._video&&this.warpper&&"function"==typeof this._video[0].webkitEnterFullScreen)this._initDom(),this.srcWaitTimeId=setInterval(function(){a._video[0].src&&(a._bindEvent(),clearInterval(a.srcWaitTimeId))},500),setTimeout(function(){a._video[0].controls=
!1},0),this._video.attr("height",this._video.attr("height")-53),this.playbarWarpper.css("display",""),this.ctrlbarWarpper.css("display","")},_initDom:function(){this.playbarWarpper=this.warpper.down("*[data-ctrl=playbar-warpper]");this.layerWarpper=this.warpper.down("*[data-layer=warpper]");this.scrollTrack=this.warpper.down("*[data-ctrl=scroll-track]");this.scrollThumb=this.warpper.down("*[data-ctrl=scroll-thumb]");this.scrollCorner=this.warpper.down("*[data-ctrl=scroll-corner]");this.playBtn=this.warpper.down("*[data-ctrl=play]");
this.ctrlbarWarpper=this.warpper.down("*[data-ctrl=ctrlbar-warpper]");this.ctrlBtn=this.warpper.down("*[data-btn=ctrlbtn]");this.fullscreenBtn=this.warpper.down("*[data-btn=fullscreen]");this.currentText=this.warpper.down("*[data-text=current]");this.durationText=this.warpper.down("*[data-text=duration]");this.playLayer=this.warpper.down("*[data-layer=play]");this.loadLayer=this.warpper.down("*[data-layer=load]")},_bindEvent:function(){this.autoScrollBinded=this.autoScroll.bind(this);this.scrolloverEvtBinded=
this.scrolloverEvt.bind(this);this.scrollMoveEvtBinded=this.scrollMoveEvt.bind(this);this.scrollEndEvtBinded=this.scrollEndEvt.bind(this);this.seekedEvtBinded=this.seekedEvt.bind(this);this.playingEvtBinded=this.playingEvt.bind(this);this.seekedEndEvtBinded=this.seekedEndEvt.bind(this);this._video.on("timeupdate",this.playingEvtBinded);this._video.on("timeupdate",this.autoScrollBinded);this._video.on("ended",this.endedEvt.bind(this));this._video.on("durationchange",this.setDuration.bind(this));this._video.on("pause",
this.pausedEvt.bind(this));this.fullscreenBtn.on("click",this.fullScreen.bind(this));this.playBtn.on("click",this.playEvt.bind(this));this.ctrlBtn.on("click",this.playEvt.bind(this));this.playbarWarpper.on("click",this.pauseEvt.bind(this));this.scrollCorner.on("touchstart",this.scrolloverEvtBinded);this.scrollTrack.on("mousedown",this.scrolltoEvt.bind(this));this.ctrlBtn.on("touchstart",this.btnDownEvt.bind(this));this.ctrlBtn.on("touchend",this.btnUpEvt.bind(this));this.playBtn.on("touchstart",this.btnDownEvt.bind(this));
this.playBtn.on("touchend",this.btnUpEvt.bind(this));this.fullscreenBtn.on("touchstart",this.btnDownEvt.bind(this));this.fullscreenBtn.on("touchend",this.btnUpEvt.bind(this))},scrolloverEvt:function(a){if(!this.first)this._video.un("timeupdate",this.autoScrollBinded),this._video.un("timeupdate",this.playingEvtBinded),this.scrollCorner.un("touchstart",this.scrolloverEvtBinded),this.starPos=a.touches[0].pageX,lib.$(document).on("touchmove",this.scrollMoveEvtBinded),lib.$(document).on("touchend",this.scrollEndEvtBinded)},
scrollMoveEvt:function(a){lib.Event.stop(a);a=a.touches[0].pageX;this.movePos=this.movePos===null?this.starPos:this.movePos;var b=this.scrollTrack.box().width,c=this.scrollThumb.box().width+a-this.movePos;this.currentText.html(this.formatTime(c/b*this._video[0].duration));this.scrollThumb.css("width",Math.max(0,Math.min(c,b))+"px");this.movePos=a},scrollEndEvt:function(){this.movePos=this.starPos=null;lib.$(document).un("touchmove",this.scrollMoveEvtBinded);lib.$(document).un("touchend",this.scrollEndEvtBinded);
this.scrollCorner.on("touchstart",this.scrolloverEvtBinded);var a=this.scrollTrack.box().width;this._video[0].currentTime=this.scrollThumb.box().width/a*this._video[0].duration;this._video.un("seeked",this.seekedEvtBinded);this._video.on("seeked",this.seekedEvtBinded)},playingEvt:function(){if(this.first)this.first=!1,this.setDuration();this._video[0].paused||(this.layerWarpper.css("display","none"),this.ctrlBtn.attr("class","ctrlstop"));this.currentText.html(this.formatTime(this._video[0].currentTime))},
playEvt:function(a){lib.Event.stop(a);this._video[0].paused?(this.showPlayLayer(!1),this._video[0].play()):this._video[0].pause()},pauseEvt:function(a){lib.Event.preventDefault(a);this._video[0].pause()},pausedEvt:function(){this.showPlayLayer(!0);this.layerWarpper.css("display","");this.ctrlBtn.attr("class","ctrlplay")},seekedEvt:function(){this._video.un("timeupdate",this.seekedEndEvtBinded);this._video.on("timeupdate",this.seekedEndEvtBinded);this._video.un("seeked",this.seekedEvtBinded)},seekedEndEvt:function(){this._video[0].readyState===
4&&(this._video.un("timeupdate",this.seekedEndEvtBinded),this._video.on("timeupdate",this.playingEvtBinded),this._video.on("timeupdate",this.autoScrollBinded))},endedEvt:function(){this.ctrlBtn.attr("class","ctrlwait")},scrolltoEvt:function(a){if(!this.first)this.scrollThumb.css("width",a.layerX+"px"),this._video[0].currentTime=a.layerX/this.scrollTrack.box().width*this._video[0].duration},btnDownEvt:function(a){lib.$(a.target)[0].className+="-a"},btnUpEvt:function(a){a=lib.$(a.target);a[0].className=
a[0].className.replace("-a","")},formatTime:function(a){if(isNaN(a))return"00:00:00";var a=Math.floor(a),b=Math.floor(a/3600);a-=3600*b;var c=Math.floor(a/60);a-=60*c;return[(b+"").replace(/^(\d)$/,"0$1"),(c+"").replace(/^(\d)$/,"0$1"),(a+"").replace(/^(\d)$/,"0$1")].join(":")},setDuration:function(){this.durationText.html(this.formatTime(this._video[0].duration))},showPlayLayer:function(a){this.playLayer.css("display",a?"":"none");this.loadLayer.css("display",a?"none":"")},fullScreen:function(a){a&&
lib.Event.stop(a);this._video[0].webkitEnterFullscreen()},autoScroll:function(){this.scrollThumb.css("width",this._video[0].currentTime/this._video[0].duration*this.scrollTrack.box().width+"px")}}});(function(){lib.kit.newJob("html5controlbar",function(){var a=new lib.kit.HTML5Controlbar;a.init();lib._PAGE_EVENT.on("html5videoCreated",function(b){b.target&&(a.init(),b.target[0].play())})});lib._PAGE_JOB.add("html5controlbar")})();
$newJob("favourite",function(){var a=window.external,b=window.sidebar,c;(c=$("#topInfoC_add")?$("#topInfoC_add")[0].style.display=="none"?$(".shoucangaddplay"):$("#j-q-favourite"):$("#j-q-favourite"))&&(/se \d\.x/.test(navigator.userAgent.toLowerCase())||lib.Maxthon||!lib.CHROME&&!lib.IE7&&(a||b))&&c.on("click",function(){var c=window.curVideoURL||location.href,e=document.title;b?b.addPanel(e,c,""):a&&("addFavorite"in a?a.addFavorite(c,e):"AddFavorite"in a&&a.AddFavorite(c,e))}).show()});
(function(){lib.Class("VideoListSlide",{ns:lib.action,extend:lib.action.Slide,construct:function(a,b){this.callsuper(a,b)},methods:{nextVideo:function(){this._model.moveNext();this.syncGet()},focusTo:function(a){this._model.focusTo(a);this.syncGet()}}})})();
(function(){lib.Class("VideoListSlideView",{ns:lib.view,extend:lib.view.SlideView,methods:{_initDom:function(){this.callsuper("_initDom");this._wrapper=lib.$("#j-videoList");this._btnShowList=lib.$("#j-showList");this._allVideos=lib.$("#j-allVideos");this._btnHideList=lib.$("#j-hideList")},_isFocus:function(a){if(a.attr("vid")==info.videoId)return!0;return!1},_setFocus:function(a,b,c){var d=lib.$(a.down("a")[0]),e=lib.$(a.down("span")[0]),f=d.attr("orinClass")||d.attr("class");d.attr("orinClass",
f);this.callsuper("_setFocus",a,b,c);d=lib.$(a.down("a")[0]);b===c.focus-1?window.curVideoURL=d.attr("href"):f=="imgBg2"&&(d.attr("class","imgBg2"),e.show())},_checkItem:function(a){return a.attr("vid")},_handleRerender:function(){var a=this._wrapper.box();this._allVideos.css("top",a.top+"px");this._allVideos.css("left",a.left+"px")},_initEvent:function(){this.callsuper("_initEvent");var a=this;if(this._btnShowList)this._btnShowList.on("click",function(b){var c=a._wrapper.box();a._allVideos.show();
var d=a._allVideos.box();a._allVideos.css("position","absolute");a._allVideos.css("width",c.width-2+"px");a._allVideos.css("top",c.top+"px");a._allVideos.css("left",c.left+"px");a._allVideos.css("height","0px");a._allVideos.css("overflow","hidden");a._allVideos.css("zIndex","10");var e=lib.ui.Anim("#j-allVideos");e.duration(100);e.ease();e.from("height",0).to("height",Math.max(c.height,d.height)-2).go();lib.Event.stop(b)});if(this._btnHideList)this._btnHideList.on("click",function(b){var c=a._wrapper.box(),
d=a._allVideos.box(),e=lib.ui.Anim("#j-allVideos");e.duration(100);e.ease();e.from("height",Math.max(c.height,d.height)-2).to("height",0).onDone(function(){a._allVideos.hide();a._allVideos.css("height","auto")}).go();lib.Event.stop(b)});lib._PAGE_EVENT.on("rerender",function(){a._handleRerender()});lib.$(window).on("resize",function(){a._handleRerender()})}}})})();
(function(){lib.Class("VideoListSlideModel",{ns:lib.model,extend:lib.model.SlideModel,construct:function(){this.callsuper()},methods:{moveNext:function(){var a=Math.floor(this._data.disp/2);this._data.focus=Math.min(this._data.focus+1,this._data.total);if(this._data.total>this._data.disp&&this._data.focus-this._data.first>a)this._data.first=Math.min(this._data.first+1,this._data.total-this._data.disp+1)},focusTo:function(a){var b=Math.floor(this._data.disp/2);this._data.focus=Math.min(a,this._data.total);
if(this._data.total>this._data.disp)a=this._data.focus-b,this._data.first=Math.min(a<=0?1:a,this._data.total-this._data.disp+1)}}})})();
(function(){lib.Class("AttentionModel",{ns:lib.model,extend:lib.model.Model,construct:function(a){this.data={list:["sina","qzone"],hash:{qzone:{type:"qzone",tpl:'<iframe src="http://open.qzone.qq.com/like?url=http%3A%2F%2Fuser.qzone.qq.com%2F${uid}&type=button&width=400&height=30&style=2" allowtransparency="true" scrolling="no" border="0" frameborder="0" style="width:64px;height:26px;border:none;overflow:hidden;float:left"></iframe>'},sina:{type:"sina",tpl:'<iframe style="margin-right:5px;float:left;" width="63" height="24" frameborder="0" allowtransparency="true" marginwidth="0" marginheight="0" scrolling="no" border="0" src="http://widget.weibo.com/relationship/followbutton.php?language=zh_cn&width=63&height=26&uid=${uid}&style=1&btn=light&dpc=1"></iframe>'}}};
a&&(a.addSinaTpl&&(this.data.hash.sina.tpl+=a.addSinaTpl),a.addQzoneTpl&&(this.data.hash.qzone.tpl+=a.addQzoneTpl))},methods:{init:function(a){this._ctrl=a},get:function(a,b){this.data.list=a||this.data.list;b(this.data)}}})})();
(function(){lib.Class("AttentionView",{ns:lib.view,extend:lib.view.View,construct:function(a){this._box=lib.$("#j-attention-list");this._btn=lib.$("#j-attention-icon");this._pAttention=lib.$("#j-pattention");this._opt=a||{};this._hasanim=this._opt.hasanim||this._box.attr("data-hasanim")||"no";this._upclass="icon_up";this._downclass="icon_down";this._timeer1=this._timeer2=null},methods:{init:function(a){this._ctrl=a},update:function(a){var b=a.list,a=a.hash;this.getUids(a);for(var c=[],d=0,e=b.length;d<
e;d++){var f=a[b[d]];this.createItem(f)&&c.push(this.createItem(f))}this._box&&this._box.show().html(c.join(""));lib.ipad?this._box.show():this.setAnim()},createItem:function(a){var b=new lib.Template(a.tpl),a=a.type;return this._hash[a]?b.evaluate(this._hash[a]):""},getUids:function(a){this._hash={};for(var b in a){this._hash[b]={};var c=this._opt[b]||this._box.attr("data-type-"+b);c?this._hash[b].uid=c:this._hash[b]=null}},setAnim:function(){if(this._box&&this._hasanim=="yes"){this._anim=lib.ui.Anim("#j-attention-list");
this._anim.duration(200);this._anim.ease("Circ.easeOut");this._start=this._box.box().height;this._box.css("height","auto");var a=this;setTimeout(function(){a._end=a._box.box().height;a._box[0].style.height=a._start+"px";a._pAttention?(a._pAttention.on("mouseenter",a._bindMouseEnter.bind(a)),a._pAttention.on("mouseleave",a._bindMouseLeave.bind(a))):(a._box.on("mouseenter",a._bindMouseEnter.bind(a)),a._box.on("mouseleave",a._bindMouseLeave.bind(a)),a._btn.on("mouseenter",a._bindMouseEnter.bind(a)),
a._btn.on("mouseleave",a._bindMouseLeave.bind(a)))},1E3)}},_bindMouseEnter:function(){var a=this;this._timeer2&&clearTimeout(this._timeer2);this._timeer1=setTimeout(function(){a._pAttention&&a._pAttention.addClass("fsBg");a._anim.stop();a._anim.from("height",a._box.box().height).to("height",a._end).onDone(function(){a._btn&&(a._btn.removeClass(a._downclass),a._btn.addClass(a._upclass))}).go()},300)},_bindMouseLeave:function(){var a=this;this._timeer1&&clearTimeout(this._timeer1);this._timeer2=setTimeout(function(){a._anim.stop();
a._anim.from("height",a._box.box().height).to("height",a._start).onDone(function(){a._btn&&(a._btn.removeClass(a._upclass),a._btn.addClass(a._downclass));a._pAttention&&a._pAttention.removeClass("fsBg")}).go()},300)}}})})();
(function(){lib.kit.newJob("attention",function(a){var b=lib.$("#j-attention-list");if(b)if(a&&a.lazyload=="no"){var b=new lib.model.AttentionModel(a),c=new lib.view.AttentionView(a);(new lib.action.Adapter(b,c)).asyncGet()}else lib.action.lazy.init("cb",{ele:b,cb:function(){var b=new lib.model.AttentionModel(a),c=new lib.view.AttentionView(a);(new lib.action.Adapter(b,c)).asyncGet()}})})})();
(function(){lib.Class("Tab",{ns:lib.action,extend:lib.action.StaticAdapter,construct:function(a,b){this.callsuper(a,b);this._evList={}},methods:{init:function(){this.callsuper("init");this._view.doBeforeEvent()},select:function(a,b){if(typeof a=="number")var c=this._view._getTitleList(),a=lib.$(c[a-1]).attr("j-tab");this._model.set({focus:a});this.syncGet();var d=this._model.get(),c=this._evList.select,e={};e.target=b;e.data=d;if(c)for(d=0;d<c.length;d++)c[d].call(null,b,e);lib.action.lazy&&lib.action.lazy.add()},
on:function(a,b){this._evList[a]||(this._evList[a]=[]);this._evList[a].push(b)}}})})();
(function(){lib.Class("TabView",{ns:lib.view,extend:lib.view.StaticView,construct:function(a){this._param={titleWrapper:"j-tabs",titleTag:"span",bodyWrapper:"j-tabBodies",bodyTag:"span",selectedClass:"selected",linkTpl:null};Object.extend(this._param,a)},methods:{init:function(a){this._ctrl=a;a=this._param.titleWrapper.split(",");this._titleWrapper=[];for(var b=0,c=a.length;b<c;b++)lib.$("#"+a[b])&&this._titleWrapper.push(lib.$("#"+a[b]));this._bodyWrapper=lib.$("#"+this._param.bodyWrapper);this._curCnt=
this._curTab=null;this._initEvent()},doBeforeEvent:function(){if(this._ctrl._evList.before)for(var a=0,b=this._ctrl._evList.before.length;a<b;a++)this._ctrl._evList.before[a].call(null,this._curCnt,this._curTab)},update:function(a){for(var b=this._getTitleList(),c=0;c<b.length;c++){var d=lib.$(b[c]);d.attr("j-tab")==a.focus?(this._curTab=d,this.selectItem(d)):this.unselectItem(d)}b=this._getBodyList();for(c=0;c<b.length;c++)d=lib.$(b[c]),d.attr("j-tab-cnt")==a.focus?(this._curCnt=d,this.show(d)):
this.hide(d)},show:function(a){a.show()},hide:function(a){a.hide()},selectItem:function(a){a.addClass(this._param.selectedClass)},unselectItem:function(a){a.removeClass(this._param.selectedClass)},getInfo:function(){for(var a=this._getTitleList(),b=0;b<a.length;b++){var c=lib.$(a[b]);if(c.hasClass(this._param.selectedClass))return{focus:c.attr("j-tab")}}return{}},_initEvent:function(){var a=this;this._titleWrapper.each(function(b){b.on("click",function(c){for(var d=c.target||c.srcElement,d=lib.$(d);!d.attr("j-tab");){if(d[0]==
b[0])return;d=d.parent()}lib.Event.stop(c);c=!0;if(a._ctrl._evList.beforeselect)for(var e=0,f=a._ctrl._evList.beforeselect.length;e<f;e++)c=a._ctrl._evList.beforeselect[e].call(null,d,a._curCnt);if(c!==!1){a._ctrl.syncSet({focus:d.attr("j-tab")});if(a._ctrl._evList.select){e=0;for(f=a._ctrl._evList.select.length;e<f;e++)a._ctrl._evList.select[e].call(null,d,a._curCnt)}lib.action.lazy&&lib.action.lazy.add()}});lib.ipad&&b.down(a._param.titleTag+"[j-tab]").each(function(a){a.on("click",function(){return!1})})})},
_getTitleList:function(){for(var a=[],b=this._titleWrapper,c=0,d=b.length;c<d;c++)if(b[c].down(this._param.titleTag))for(var e=b[c].down(this._param.titleTag).elements(),f=0,g=e.length;f<g;f++)lib.$(e[f]).attr("j-tab")&&a.push(e[f]);return a},_getBodyList:function(){var a=this._bodyWrapper?this._bodyWrapper.down(this._param.bodyTag):null,b=[];if(a)for(var c=0;c<a.length;c++){var d=lib.$(a[c]);d.attr("j-tab-cnt")&&b.push(d)}return b}}})})();
(function(){lib.Class("VideoListTabView",{ns:lib.view,extend:lib.view.TabView,construct:function(a){this.callsuper(a);this._pageSize=75},methods:{getInfo:function(){for(var a=this._getTitleList(),b=0;b<a.length;b++){var c=lib.$(a[b]);if(c.hasClass(this._param.selectedClass))return{focus:c.attr("j-tab")}}return{focus:"page1"}},focus:function(a){var b=Math.ceil(a/this._pageSize)-1,c=a-this._pageSize*b,d=this._getTitleList(),e=this._getBodyList();if(d.length>0)b=lib.$(d[b]).attr("j-tab");else if(e.length>
0)b=lib.$(e[b]).attr("j-tab-cnt");else return;d=this._curCnt.down("span");for(e=0;e<d.length;e++)lib.$(d[e]).attr("class","");this._ctrl.select(b);d=this._curCnt.children();for(e=0;e<d.length;e++)lib.$(d[e]).attr("class","");lib.$(d[c-1]).attr("class","curPage");lib.$("#j-curTitle")&&lib.$("#j-curTitle").html(lib.$("#j-curTitle").html().replace(/\d+/,a))}}})})();(function(){lib.Class("TabModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this._data={focus:""}}})})();
(function(){lib.Class("SnsModel",{ns:lib.model,extend:lib.model.Model,construct:function(){},methods:{get:function(a,b){lib.model({crossDomain:!0,actions:{ac:{method:"post",params:["action","vname","vurl","vchannel"],format:"json",encode:!1,url:"add.php",timeout:1E4}},url:"http://i."+lib.SITE_DOMAIN+"/apis/tongbu/"}).ac(a,{success:function(a){b(a.bind)},failure:function(a){b(a)}})}}})})();
(function(){lib.kit.newJob("sns",function(){if($("#j-link1")&&$("#j-link2")&&$("#j-link3")){var a=new lib.model.SnsModel;lib.sns={behaviorSync:function(b,c){a.get(b,c)}}}});lib._PAGE_JOB.add("sns")})();

(function(){lib.Class("MarkModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this.callsuper();this._geturl="http://score.video.qiyi.com/ud/";this._seturl="http://score.video.qiyi.com/upud/";this._setQitanUpUrl="http://api.t."+lib.SITE_DOMAIN+"/api/like/addVideoLike.php";this._setQitanDownUrl="http://api.t."+lib.SITE_DOMAIN+"/api/like/addVideoStep.php"},methods:{get:function(a,b){a=a||{};Object.extend(a,{varname:"ud"});var c=this;window.__LT__&&(__LT__.i.mark=new Date);lib.kit.util.jsLoad.request(this._geturl,
{CACHE:a,onSuccess:function(a){window.__LT__&&(__LT__.i.mark=new Date-__LT__.i.mark);c._data.success=!0;c._data.data=a;b(c._data)},onError:function(){}})},set:function(a,b){var c={tvid:a.tvid,albumId:a.albumId,updown:a.updown};Object.extend(c,{varname:"ud"});var d=this;lib.kit.util.jsLoad.request(this._seturl,{CACHE:c,onSuccess:function(c){d._data.success=!0;d.setQitan(a,c);d._data.data=c;b(d._data)},onError:function(){}})},syncSet:function(a){return Object.extend(this._data,a)},setQitan:function(a,
b){var b=b||{},c=parseInt(a.updown)>0?this._setQitanUpUrl:this._setQitanDownUrl;lib.kit.util.jsLoad.request(c,{GET:{uid:lib.component.login.getUserInfo().uid||"",num:parseInt(a.updown)>0?b.up||"":b.down||"",tv_id:a.tvid||"",album_id:a.albumId||"",aid:a.qitanId||"",appid:"1",cb:"cb_"+Math.ceil(Math.random()*1E5).toString(32)}})}}})})();
(function(){lib.kit.newJob("mark",function(a){if($("#j-dot")){var b=new lib.model.MarkModel,a=new lib.view.MarkView(a),b=new lib.action.Mark(b,a);b.asyncGet({albumId:info.albumId});b.listeningEvent()}lib._PAGE_JOB.add("sns")})})();
(function(){lib.kit.newJob("videolist",function(){var a=new lib.model.VideoListSlideModel,b=new lib.view.VideoListSlideView,c=new lib.action.VideoListSlide(a,b);c.init();var b=new lib.model.TabModel,d=new lib.view.VideoListTabView;(new lib.action.Tab(b,d)).init();d.focus(a.get().focus);var e=lib.kit.QiyiPlayer.getPlayer("flash");e.on("StartPlay",function(a){a=a||{};info.tvId!=a.tvid&&e.getVideoInfo(function(a){var a=a||{},b=a.vid,c=a.vn,d=a.info,e=a.vpic,a=a.tvid;c&&nextVideo(b,c,"",d,e,a)})});window.nextVideo=
function(b,e,h,i,j,k){try{lib.action.NewPlayHistory.instance.playNextVideoStatic(b,e,k)}catch(n){}c.nextVideo();d.focus(a.get().focus);h=/((?:-.*){3})$/.exec(document.title);h=e+(h?h[1]:"-\u514d\u8d39\u9ad8\u6e05\u7f51\u7edc\u89c6\u9891\u89c2\u770b-\u5947\u827a");document.title=h;e&&lib.$("#navbar").html(e);i&&((e=lib.$("#j-descAll"))?e.html(i):(e=lib.$("#descElement"))&&e.html(i));lib._PAGE_EVENT.fire({type:"changeVideo",data:{vid:b,title:h,tvd:k}});lib._PAGE_EVENT.fire({type:"playnext",data:{vid:b,
title:h}})}})})();
(function(){lib.Class("LazySlideModel",{ns:lib.model,extend:lib.model.SlideModel,construct:function(a){this.callsuper();this._url="http://cache.video.qiyi.com/avlist/";this._vlistModel=a;this._data.cache=[];this._data.pagesize=a.getInfo().pagesize},methods:{init:function(a){this._ctrl=a},prev:function(){this._data.step="prev";this._data.disp>1?(this._data.first=Math.max(this._data.first-(this._data.disp-1),1),this.check()):this._data.first=Math.max(this._data.first-1,1)},next:function(){this._data.step=
"next";if(this._data.disp>1){if(this._data.total>this._data.disp)this._data.first=Math.min(this._data.first+(this._data.disp-1),this._data.total-this._data.disp+1);this.check()}else this._data.first=Math.min(this._data.first+1,this._data.total)},check:function(a){var b=this;if(this._data.cache.length==0)this._vlistModel.getInitData(function(c){if(c&&c.vlist&&c.vlist.length>0){b._data.cache=(b._data.cache||[]).concat(c.vlist);if(c.pt)b._data.total=c.pt;b._data.ps=c.ps;b._data.firstPage=Math.ceil(b._data.cache[0].pd/
b._data.pagesize);lib.log("first pd : "+b._data.cache[0].pd);lib.log("first page : "+b._data.firstPage);b._ctrl.initView();b._ctrl.add(c)}a&&c.isFinished&&a()},function(c){if(c&&c.vlist&&c.vlist.length>0)b._data.cache=(b._data.cache||[]).concat(c.vlist),b._ctrl.add(c);a&&c.isFinished&&a()});else if(this._data.step=="prev"){var c=this._data.first-(this._data.disp-1);c<=b._data.cache[0].pd&&this._vlistModel.getData(this._data,function(c){if(c&&c.vlist&&c.vlist.length>0)b._data.cache=c.vlist.concat(b._data.cache),
b._ctrl.add(c);a&&a()})}else{var d=b._data.cache.length,c=this._data.first+(this._data.disp-1);c+this._data.disp-1>=b._data.cache[d-1].pd&&this._vlistModel.getData(this._data,function(c){if(c&&c.vlist&&c.vlist.length>0)b._data.cache=b._data.cache.concat(c.vlist),b._ctrl.add(c);a&&a()})}}}})})();
(function(){lib.Class("VideoListLazySlideModel",{ns:lib.model,extend:lib.model.LazySlideModel,construct:function(a){this.callsuper(a)},methods:{moveNext:function(){var a=Math.floor(this._data.disp/2);this._data.focus=Math.min(this._data.focus+1,this._data.total);if(this._data.total>this._data.disp&&this._data.focus-this._data.first>a)this._data.first=Math.min(this._data.first+1,this._data.total-this._data.disp+1);this.check()},focusTo:function(a,b){this._data.step=a>this._data.focus?"next":"prev";
var c=Math.floor(this._data.disp/2);this._data.focus=Math.min(a,this._data.total);if(this._data.total>this._data.disp&&(this._data.first=Math.min(this._data.focus-c,this._data.total-this._data.disp+1),this._data.first<1))this._data.first=1;lib.log("first : "+this._data.first);this._data.cache=[];this._vlistModel._page=a;var d=this;this.check(function(){b&&b();d.check()})}}})})();
(function(){lib.Class("VideoListLazySlideView",{ns:lib.view,extend:lib.view.SlideView,construct:function(a){this.callsuper(a)},methods:{rebuild:function(a){for(var b=new lib.Template('<span _page="${page}" style="width:${width}px;display:inline-block;"></span>'),c=Math.ceil(a.total/a.pagesize),d="",e=0;e<c;e++)d+=b.evaluate({page:e+1,width:Math.min(this.itemWidth*a.pagesize,this.itemWidth*(a.total-e*a.pagesize))});this._allList.html(d);this._allList.css("width",this.itemWidth*a.pagesize*c+"px");b=
Math.ceil(parseInt(lib.$("#j-curr").val())/a.pagesize);this._start=this.itemWidth*a.pagesize*(b-1)},_initDom:function(){this.callsuper("_initDom");this._wrapper=lib.$("#j-videoList");this._btnShowList=lib.$("#j-showList");this._allVideos=lib.$("#j-allVideos");this._btnHideList=lib.$("#j-hideList")},display:function(a){this._rawPlayAnim=this._playAnim;this._playAnim=function(){this._end=this.itemWidth*(1-a.first);this._allList.css(this.animDir,this._end+"px");this._start=this._end};try{this.update(a)}catch(b){lib.log(b)}this._playAnim=
this._rawPlayAnim},append:function(a){if(a.pg){var b=lib.$('span[_page="'+a.pg+'"]'),c="",d=this;a.vlist.forEach(function(a){var f={};Object.extend(f,a);if(a=f.vpic)f.vpic=a.replace(/\.\w+$/,""),f.vpictype=a.replace(/^.*\./,"");if(!b.down('li[vid="'+f.vid+'"]'))f.pubTime&&d.preTpl?(f.psmonth=f.pubTime.substring(0,2),f.psday=f.pubTime.substring(2,4),f.pshour=f.pubTime.substring(4,6),f.psmin=f.pubTime.substring(6,8),c+=d.preTpl.evaluate(f)):(f.fullvt=f.vt,f.vt=f.vt.trancate(18),c+=d.itemTpl.evaluate(f))});
a.ps&&this.subTpl&&(c+=this.subTpl.evaluate({ps:a.ps}),b.css("width",b.box().width+this.itemWidth+"px"));b.html(c);a.ps&&this.subTpl&&lib._PAGE_EVENT.fire({type:"lazylistload"});this._list=this._allList.down(this.itemTag);lib.log(this._list.length)}},checkFocus:function(a){var b=this.callsuper("checkFocus");b+=(parseInt(lib.$(this._list[0].parentNode).attr("_page"))-1)*a.pagesize;return b},_recurItem:function(a){var b=((a.firstPage||parseInt(lib.$(this._list[0].parentNode).attr("_page")))-1)*a.pagesize+
1;lib.log("startSeq : "+b);for(var c=0;c<this._list.length;c++){var d=lib.$(this._list[c]);d.attr("vid")&&(this._setFocus(d,c+b-1,a),this._loadImg(d,c+b-1,a))}},_isFocus:function(a){if(a.attr("vid")==info.videoId)return!0;return!1},_setFocus:function(a,b,c){this.callsuper("_setFocus",a,b,c);var d=lib.$(a.down("a")[0]),a=lib.$(a.down("span")[0]),e=d.attr("orinClass")||d.attr("class");b===c.focus-1?window.curVideoURL=d.attr("href"):e=="imgBg2"&&(d.attr("class","imgBg2"),a.show())},_handleRerender:function(){var a=
this._wrapper.box();this._allVideos.css("top",a.top+"px");this._allVideos.css("left",a.left+"px")},getInfo:function(){for(var a=1,b=1,c=parseInt(lib.$("#j-total").val()),b=0;b<this._list.length;b++)this._isFocus(lib.$(this._list[b]))&&(a=b+1);b=Math.max(1,Math.min(a-3,c-this.disp+1));return{first:b,focus:a,total:c,disp:this.disp}},_initEvent:function(){this.superclass.prototype._initEvent.call(this);var a=this;if(this._btnShowList)this._btnShowList.on("click",function(b){var c=a._wrapper.box();a._allVideos.show();
var d=a._allVideos.box();a._allVideos.css("position","absolute");a._allVideos.css("width",c.width-2+"px");a._allVideos.css("top",c.top+"px");a._allVideos.css("left",c.left+"px");a._allVideos.css("height","0px");a._allVideos.css("overflow","hidden");a._allVideos.css("zIndex","10");var e=lib.ui.Anim("#j-allVideos");e.duration(100);e.ease();e.from("height",0).to("height",Math.max(c.height,d.height)-2).go();lib.Event.stop(b)});if(this._btnHideList)this._btnHideList.on("click",function(b){var c=a._wrapper.box(),
d=a._allVideos.box(),e=lib.ui.Anim("#j-allVideos");e.duration(100);e.ease();e.from("height",Math.max(c.height,d.height)-2).to("height",0).onDone(function(){a._allVideos.hide();a._allVideos.css("height","auto")}).go();lib.Event.stop(b)});lib._PAGE_EVENT.on("rerender",function(){a._handleRerender()});lib.$(window).on("resize",function(){a._handleRerender()})}}})})();
(function(){lib.Class("LazySlide",{ns:lib.action,extend:lib.action.Slide,construct:function(a,b){this.callsuper(a,b)},methods:{init:function(a){var a=a||{},b={},c=this._view.getInfo();Object.extend(b,a);Object.extend(b,c);this._model.set(b);var d=this;this._model.check(function(){var a=d._model.get(),b=d._view.checkFocus(a);d._model.moveToFocus(b);d._view.display(a)})},initView:function(){this._view.rebuild(this._model.get())},add:function(a){var b=this._model.get();a.pg==Math.ceil(a.pt/b.pagesize)&&
a.pt!=a.pm?a.vlist.some(function(a){if(a.pubTime)return!0;return!1})?a.ps="":a.ps&&this._model.set({total:b.total+1}):a.ps="";this._view.append(a)}}})})();(function(){lib.Class("VideoListLazySlide",{ns:lib.action,extend:lib.action.LazySlide,construct:function(a,b){this.callsuper(a,b)},methods:{nextVideo:function(){this._model.moveNext();this.syncGet()},focusTo:function(a,b){var c=this;this._model.focusTo(a,function(){lib.log("ready to update");c.syncGet();b&&b()})}}})})();
(function(){lib.Class("VideoListLazyTabView",{ns:lib.view,extend:lib.view.TabView,construct:function(a){this.callsuper(a);this._pageSize=75;this.buildTab()},methods:{getInfo:function(){for(var a=this._getTitleList(),b=0;b<a.length;b++){var c=lib.$(a[b]);if(c.hasClass(this._param.selectedClass))return{focus:c.attr("j-tab")}}return{focus:"page1"}},focus:function(a){var b=Math.ceil(a/this._pageSize)-1,c=a-this._pageSize*b,d=this._getTitleList(),e=this._getBodyList();if(d.length>0&&d[b])b=lib.$(d[b]).attr("j-tab");
else if(e.length>0&&e[b])b=lib.$(e[b]).attr("j-tab-cnt");else return;if(d=this._curCnt.down("span"))for(e=0;e<d.length;e++)lib.$(d[e]).attr("class","");this._ctrl.select(b);if(d=this._curCnt.down("span")){for(e=0;e<d.length;e++)lib.$(d[e]).attr("class","");lib.$(d[c-1]).attr("class","curPage")}lib.$("#j-curTitle")&&lib.$("#j-curTitle").html(lib.$("#j-curTitle").html().replace(/\d+/,a))},buildTab:function(){for(var a=parseInt(lib.$("#j-total").val()),b=Math.ceil(a/this._pageSize),c=[],d=[],e=lib.$("#j-tabs").down("*[j-tab]"),
f=lib.$("#j-tabs"),g=0;g<b;g++)f.attr("j-type")!="discontinuous"?c.push('<span j-tab="page'+(g+1)+'" _tabpage="'+(g+1)+'">'+(g*this._pageSize+1)+"-"+Math.min((g+1)*this._pageSize,a)+"</span>"):e[g]&&lib.$(e[g]).attr("_tabpage",g+1),d.push('<span style="display: none;" j-tab-cnt="page'+(g+1)+'"></span>');c.length>0&&(c=c.join('<span class="gui_line">|</span>'),lib.$("#j-tabs").html(c));lib.$("#j-tabBodies").html(d.join(""))}}})})();
(function(){lib.kit.newJob("videolistLazy",function(a){var a=a||{},b=new lib.model.VlistModel({page:parseInt(lib.$("#j-curr").val())}),c=new lib.model.VideoListLazySlideModel(b),a=new lib.view.VideoListLazySlideView(a),d=new lib.action.VideoListLazySlide(c,a);d.init();var a=new lib.model.TabModel,e=new lib.view.VideoListLazyTabView,f=new lib.action.Tab(a,e);f.on("select",function(){var a=lib.$("#j-tabs"),a=(a.down('span[class=" selected"]')||a.down('span[class="selected"]')||a.down('span[classname=" selected"]')||
a.down('span[classname="selected"]')).attr("_tabpage");lib.log("tab page : "+a);var d=lib.$('span[j-tab-cnt="page'+a+'"]');d.html()==""&&b.getDataByPage(a,function(a){if(a.pg){var b=new lib.Template('<span class="${selected}"><a title="${vn}" href="${vurl}">${pd}</a></span>'),e=new lib.Template('<span class=""><a href="${vurl}" class="last_new" ><span title="${ps}" class="" j-delegate="genbo">\u9884${pd}</span></a></span>'),f=[];a.vlist.forEach(function(d){if(d.pd==c.get().focus)d.selected="curPage";
d.pubTime?(d=Object.extend({ps:a.ps},d),f.push(e.evaluate(d))):f.push(b.evaluate(d))});d.html(f.join(""))}})});f.init();setTimeout(function(){f.select(Math.ceil(parseInt(lib.$("#j-curr").val())/c.get().pagesize))},3E3);var g=lib.kit.QiyiPlayer.getPlayer("flash");g.on("DataReady",function(a){lib.log("DataReady's data : "+a);var a=a||{},b=a.curPlayingIndex;info.tvId!=a.tvid&&g.getVideoInfo(function(a){var a=a||{},c=a.vid,d=a.vn,e=a.info,f=a.vpic,g=a.tvid,a=a.vu;d&&nextVideo(c,d,"",e,f,g,b,a)})});window.nextVideo=
function(a,b,f,g,n,l,m,o){try{lib.action.NewPlayHistory.instance.playNextVideoStatic(a,b,l)}catch(p){}lib.log("next video index : "+m);m==-1?(d.nextVideo(),e.focus(c.get().focus)):d.focusTo(m+1,function(){e.focus(c.get().focus)});f=/((?:-.*){3})$/.exec(document.title);f=b+(f?f[1]:"-\u514d\u8d39\u9ad8\u6e05\u7f51\u7edc\u89c6\u9891\u89c2\u770b-\u5947\u827a");document.title=f;b&&lib.$("#navbar").html(b);g&&lib.$("#j-descAll").html(g);lib._PAGE_EVENT.fire({type:"changeVideo",data:{vid:a,title:f,tvid:l,
playurl:o}});lib._PAGE_EVENT.fire({type:"playnext",data:{vid:a,title:f}})}})})();
$reg("lib.action.Switch",function(){lib.action.Switch=function(){};Object.extend(lib.action.Switch.prototype,{initElement:function(){if($("#j-maskLayer-switch"))this.maskLayer=$("#j-maskLayer-switch"),this.maskDot=this.maskLayer.down("a");else{var a=document.body;this.maskLayer=lib.Element.create("div");this.maskLayer.addClass("newDot");this.maskLayer.attr("id","j-maskLayer-switch");this.maskDot=lib.Element.create("a").hide();this.maskDot.addClass("newDotLink");if($("#flashArea").css("position")==
"relative")this._subMask=lib.Element.create("div"),this._subMask.addClass("newDot"),$("#flashArea").append(this._subMask);a.appendChild(this.maskLayer.elements()[0],a.firstChild);this.maskLayer.append(this.maskDot)}this.setBoxSize()},initEvent:function(){if(!this.attached)this.maskDot.on("click",this.dotClick.bind(this)),this.maskLayer.on("mousemove",this.maskOnMove.bind(this)),lib.Event.on(window,"resize",this.setBoxSize.bind(this)),lib.Event.on(window,"load",this.setBoxSize.bind(this)),this.attached=
!0},maskOnMove:function(){if(!this.dotShow)this.dotShow=!0,this.maskDot.show(),this.maskDot.css("zIndex","2001"),setTimeout(function(){this.maskDot.hide();this.dotShow=!1}.bind(this),3E3)},toggle:function(a){this.flag?(this.flag=!1,this.close()):(this.flag=!0,this.open());a&&a(this.flag)},setLight:function(a){a.open=="false"?(this.flag=!1,this.open()):(this.flag=!0,this.close())},dotClick:function(){this.flag=this.maskShow=!1;this.close();lib.kit.QiyiPlayer.getPlayer("flash").setLight("true")},setBoxSize:function(){var a,
c;this.maskLayer.css("height",this._getBrowserHeight()+"px");lib.IE6?(a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),a=a<c?lib.box.getViewportWidth():a):a=lib.IE7||lib.IE8||lib.IE9?Math.max(document.documentElement.clientWidth,document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth)-1:Math.max(document.documentElement.clientWidth,document.body.scrollWidth,document.documentElement.scrollWidth,
document.body.offsetWidth,document.documentElement.offsetWidth);this.maskLayer.css("width",a+"px");this._subMask&&(this._subMask.css("width",$("#flashArea").box().width+"px"),this._subMask.css("height",$("#flashArea").box().height+"px"))},open:function(){this.initElement();this.initEvent();this.clear();this.setBoxSize();this.maskShow=!0;this.maskLayer.show();this._subMask&&($("#flashArea").css("zIndex",2E3),this._subMask.show());$("#flashbox").css("zIndex",2E3);$("#flashbox").css("background","#000");
this.anim(0.1,1,0.1,this.openDone.bind(this))},clear:function(){this.animTimer&&clearTimeout(this.animTimer);this.maskLayer.attr("style","");this._subMask&&this._subMask.attr("style","")},anim:function(a,c,d,e){a+=d;this.maskLayer.css("opacity",a);this._subMask&&this._subMask.css("opacity",a);d<0&&a<=c||d>0&&a>=c?e():this.animTimer=setTimeout(function(){this.anim(a,c,d,e)}.bind(this),50)},clearOpacity:function(){this.maskLayer.attr("style","");this._subMask&&this._subMask.attr("style","");this.setBoxSize()},
close:function(){this.maskShow=!1;this.anim(0.9,0.1,-0.1,this.closeDone.bind(this));$("#flashbox").css("background","none")},openDone:function(){this.animTimer=null;this.maskOnMove()},closeDone:function(){this.animTimer=null;$("#flashbox").css("zIndex","1");$("#flashArea").css("zIndex","");this.maskDot.hide();this.maskLayer.attr("style","");this._subMask&&this._subMask.attr("style","");this.maskLayer.hide()},_getBrowserHeight:function(){var a=document.documentElement.scrollHeight,c=document.documentElement.clientHeight;
return a<c?c:a}});var a=new lib.action.Switch;lib._PAGE_EVENT.on("swf_setLight",function(b){b=b||{};a.setLight(b.data)});lib._PAGE_EVENT.on("page_setLight",function(){a.dotClick()});lib._PAGE_EVENT.on("openLight",function(){a.dotClick()})});
lib.Class("OpenWinPlay",{ns:lib.action,construct:function(){this.bindEvent()},methods:{bindEvent:function(){var a=this;lib._PAGE_EVENT&&lib._PAGE_EVENT.on("swf_openNewWindow",function(b){b=b||{};b.data=b.data||{};a.flashVars=b.data;a.open()})},open:function(){var a,b;lib.$("#flash").box().height<=520?(a=690,b=490):(a=600,b=450);lib.__wReference=window.open("http://www."+lib.SITE_DOMAIN+"/common/popupplayer.html?"+this._getParams(),"popout","width="+a+", height="+b+",status,resizable");lib.__wReference&&
lib.__wReference.focus()},_getParams:function(){return(new lib.kit.Url).serialize({flashVars:encodeURIComponent((new lib.kit.Url).serialize(this.flashVars)),title:encodeURIComponent(document.title)})}}});(function(){lib.kit.newJob("openwinplay",function(){new lib.action.OpenWinPlay});lib._PAGE_JOB.add("openwinplay")})();
lib.Class("Ad",{ns:lib.action,statics:{render:function(){(new lib.kit.Monitor(function(){if(lib.ad)for(var a=0;a<lib.ad.length;a++)for(var b=lib.ad[a],c=0;c<b.length;c++){var d=b[c];if(!lib.$("#"+d.id))return!1;lib.$("#"+d.wrapper)&&(lib.$("#"+d.wrapper).append(lib.$("#"+d.id)),lib.$("#"+d.id).show())}else return!1})).start()}}});
$reg("lib.action.looking",function(){lib.action.looking=function(a){function b(){d.html(o);d.parent().attr("class","close");lib.ipad?f.css("height",n+"px"):g.from("height",i).to("height",n).onDone(function(){}).go();l=!0}function c(){lib.ipad?(f.css("height",i+"px"),d.html(m),d.parent().attr("class","open")):g.from("height",n).to("height",i).onDone(function(){d.html(m);d.parent().attr("class","open")}).go();l=!1}var a=a||{},d=a.openBtn||$("#j-lookingOpen"),e=a.closeBtn||$("#j-lookingClose"),f=a.lookingBd||
$("#j-lookingBd"),g=lib.ui.Anim(f),h=a.userDefHeight||40;if(f){var i=a.minHeight||f.box().height,j=a.total||f.down("li").length,k=a.perRow||5,n=a.maxHeight||i+f.box().height*(Math.ceil(j/k)-1)+h,l=a.isOpen||!1;j>k&&d.parent().css("display","");g.duration(100);var m=d.html(),o=e.html();d.on("click",function(a){lib.Event.stop(a);l?c():b()});e.on("click",function(a){lib.Event.stop(a);c()});l&&b()}}});
(function(){lib.kit.newJob("looking10",function(){setTimeout(function(){var a=$("#j-lookingBd");a.css("height",a.box().height*2+"px");lib.action.looking({maxHeight:a.box().height/2*Math.ceil(a.down("li").length/5)+40})},0)})})();lib.kit.newJob("tvMayLove",function(){var a=new lib.model.TabModel,b=new lib.view.TabView({titleWrapper:"j-mayLoveTab",bodyWrapper:"j-mayLoveBody",bodyTag:"ul"}),a=new lib.action.Tab(a,b);a.init();a.on("select",function(){try{lib.action.lazy.add()}catch(a){}})});
lib.kit.newJob("tvRelative",function(){var a=lib.$("#j-showMore");if(a){var b=lib.$("#j-relBody"),c=lib.$("#j-moreRel"),d=a.html(),e=!0;if(b&&c)a.on("click",function(f){lib.Event.stop(f);b.css("display")=="none"?(c.hide(),b.show(),a.html(d),a.parent().attr("class","open")):(b.hide(),c.show(),a.html("\u6536\u8d77"),a.parent().attr("class","close"),e&&(lib.action.lazy.add(),e=!1))})}});
lib.kit.newJob("tvIntro",function(){function a(){var a=new lib.model.TabModel,c=new lib.view.TabView({titleWrapper:"j-tab-nav",bodyWrapper:"j-tab-content",bodyTag:"div"});(new lib.action.Tab(a,c)).init()}a();lib._PAGE_EVENT.on("filmInfoUpdated",function(){a()})});(function(){lib.kit.newJob("ad",function(){lib.action.Ad.render()})})();
(function(){lib.kit.newJob("qitanCommon",function(){var a=lib.$("#j-gui-qitan")||lib.$("#j-filmreview-box");if(a){var a=a.attr("id"),b=window.info||{};b.data=b.data||{};var c=window.albumInfo||{},d={cmdId:a,tvId:b.tvId||"0",qitanId:b.data.qitanId||c.qitanId||"0",categoryId:b.data.categoryId||"0",title:b.title||"",playurl:b.url||""},e;lib.action.lazy.init("cb",{ele:$("#"+a),cb:function(){seajs.use("http://static.qiyi.com/js/qitanv6/qitan_video_page.js",function(a){e=a;a.init(d)})}});lib._PAGE_EVENT.on("changeVideo",
function(a){a=a||{};a.data=a.data||{};if(a.data.tvId||a.data.tvid)d.tvId=a.data.tvId||a.data.tvid;if(a.data.qitanId)d.qitanId=a.data.qitanId;if(a.data.categoryId)d.categoryId=a.data.categoryId;if(a.data.playurl||a.data.videoUrl)d.playurl=(a.data.playurl||a.data.videoUrl).match(/[^\?]*/)[0];if(a.data.videoName||a.data.title)d.title=a.data.videoName||a.data.title;e&&e.reload(d)});lib.component.login.setCallback("login",function(){e&&e.userStatusChange(1)});lib.component.login.setCallback("logout",function(){e&&
e.userStatusChange(0)})}});lib._PAGE_JOB.add("qitanCommon")})();(function(){lib.Class("PlayCountModel",{ns:lib.model,extend:lib.model.Model,construct:function(){this._geturl="http://cache.video.qiyi.com/p/"},methods:{get:function(a,b){a=a||{};Object.extend(a,{varname:"playCount_"+a.aid});window.__LT__&&(__LT__.i.playcount=new Date);lib.kit.util.jsLoad.request(this._geturl,{CACHE:a,onSuccess:function(a){window.__LT__&&(__LT__.i.playcount=new Date-__LT__.i.playcount);b(a)},onError:function(){b({})}})}}})})();
(function(){lib.Class("PlayCountView",{ns:lib.view,extend:lib.view.View,construct:function(){this._elem=lib.$("#j-playCount")||$("#playCount")},methods:{init:function(){},update:function(a){if(this._elem)a=~a&&a,a+="",a=a.divideNumber(),this._elem=lib.$("#j-playCount")||$("#playCount"),this._elem.html(a)}}})})();
(function(){lib.kit.newJob("playCount",function(){var a=lib.$("#j-playCount")||$("#playCount"),b;a&&(lib.action.lazy.init("cb",{ele:a,cb:function(){var a=new lib.view.PlayCountView,d=new lib.model.PlayCountModel;b=new lib.action.Adapter(d,a);b.asyncGet({aid:info.albumId||albumInfo.albumId})}}),lib._PAGE_EVENT.on("filmInfoUpdated",function(a){b&&b.asyncGet({aid:a.data.albumId+""})}))})})();
Object.extend(lib.flash,{zoomIn:function(){var a=info.data,b=a.flashHeight,c=$("#flash")[0];c.width=a.flashWidth;c.height=b;$("#flashArea").css("height",b+"px");lib._PAGE_EVENT.fire({type:"rerender"});return!0},zoomOut:function(){var a=info.data,b=a.flashH,c=$("#flash")[0];c.width=a.flashW;c.height=b;$("#flashArea").css("height",b+"px");lib._PAGE_EVENT.fire({type:"rerender"});return!0}});
$reg("lib.module.Douban",function(){lib.module.Douban=Class.create({initialize:function(a){(new Interface(ReqUrl.douban,"jsload")).request({CACHE:{varname:"doubanVar",subjectId:a.subjectId},onSuccess:a.onSuccess,onError:function(){}})}})});
$reg("lib.tpl.douban",function(){lib.tpl.douban={title:'<h2 j-tab="douban" style="display:none;" id="j-douban-tabTitle"><span>\u8c46\u74e3\u5f71\u8bc4</span></h2>',content:'<div j-tab-cnt="douban" style="display: none;" id="j-douban-content"></div>',entryContainerHeader:"",entry:'<dl><dt><a href="${href}" target="_blank" title="${fullTitle}" alt="${title}">${title}</a></dt><\!--dd class="userName">\u8c46\u74e3\u7f51\u53cb\uff1a${name}</dd--\><dd>${summary} <a href="${href}" target="_blank">\u5168\u6587&gt;&gt;</a></dd></dl>',
entryContainerFooter:"",viewAll:'<p><a href="${href}" class="moreC" target="_blank">\u67e5\u770b\u5168\u90e8&gt;&gt;</a></p>'}});
$reg("lib.action.Douban",function(){lib.action.Douban=Class.create({initialize:function(){this.tpl=lib.tpl.douban},load:function(a){var b=this;new lib.module.Douban({subjectId:a,onSuccess:function(a){var d=b.tpl,e=[d.entryContainerHeader],f=new lib.Template(d.entry),g=a.entry;if(g.length){b.showTitle();for(var h=0,i=g.length;h<i;h++){if(h==3)break;e.push(f.evaluate({href:g[h].link[1]["@href"],fullTitle:g[h].title.$t,title:g[h].title.$t.trancate(36,".."),name:g[h].author.name.$t,summary:g[h].summary.$t.trancate(74,
"..")}))}e.push(d.entryContainerFooter);e.push((new lib.Template(d.viewAll)).evaluate({href:a.link[0]["@href"].replace(/reviews$/,"")}));$("#j-douban-content")&&$("#j-douban-content").html(e.join(""))}}})},showTitle:function(){if($("#j-douban-tit-txt")&&$("#j-douban-tit-s"))$("#j-douban-tit-txt")[0].style.display="",$("#j-douban-tit-s")[0].style.display=""},init:function(){}})});
lib.kit.newJob("douban",function(){var a=info.tvDoubanSubjectId;if(a){var b=new lib.action.Douban;b.init();b.load(a);lib._PAGE_EVENT.on("filmInfoUpdated",function(a){b.load(a.data.tvDoubanSubjectId)})}});

(function(){lib.Class("MoreLessView",{ns:lib.view,extend:lib.view.StaticView,construct:function(a){this._param={moreWrapper:null,lessWrapper:null,moreButton:null,lessButton:null};Object.extend(this._param,a)},methods:{init:function(a){this._ctrl=a;this._moreWrapper=$("#"+this._param.moreWrapper);this._lessWrapper=$("#"+this._param.lessWrapper);this._moreButton=this._param.moreButton?$("#"+this._param.moreButton):this._getMoreButton();this._lessButton=this._param.lessButton?$("#"+this._param.lessButton):
this._getLessButton();this._initEvent()},update:function(){},getInfo:function(){},_getMoreButton:function(){return this.moreButton?$("#"+this.moreButton):this._lessWrapper.down("a")},_getLessButton:function(){return this.lessButton?$("#"+this.lessButton):this._moreWrapper.down("a")},_initEvent:function(){var a=this;this._moreButton.on("click",function(b){lib.Event.stop(b);a._lessWrapper.hide();a._moreWrapper.show()});this._lessButton.on("click",function(b){lib.Event.stop(b);a._moreWrapper.hide();
a._lessWrapper.show()})}}})})();(function(){lib.Class("MoreLess",{ns:lib.action,extend:lib.action.StaticAdapter,construct:function(a,b){this.callsuper(a,b)}})})();(function(){lib.kit.newJob("commonMoreLess",function(a){var b=$("#"+a.moreWrapper),c=$("#"+a.lessWrapper);b&&c&&b.down("a")&&c.down("a")&&(b=new lib.model.MoreLessModel,a=new lib.view.MoreLessView({moreWrapper:a.moreWrapper,lessWrapper:a.lessWrapper,moreButton:a.moreButton,lessButton:a.lessButton}),(new lib.action.MoreLess(b,a)).init())})})();
lib.kit.newJob("announceForLogin",function(){function a(){lib.component.login.isLogin()?window.location.href=d+"?seed="+c:(isTrack=!0,lib.component.login.show(function(){b("showdiv")},{regUrl:c==2?"":d,btnId:e}),lib._PAGE_EVENT.on("loginclose",function(a){if(!((!a.data||!a.data.btnId)&&a.data.btnId!=e)&&isTrack&&!lib.component.login.isLogin()){if(c==2)window.location.href=d+"?seed="+c;b("clkclose");isTrack=!1}}))}function b(a){lib.kit.slog.log({type:"genbotrailer20121122",jsuid:lib.cookie.get("QC006"),
flshuid:lib.cookie.get("QC005"),qtcurl:location.href,weid:window.webEventID,act:a,ppuid:lib.component.login.getUserInfo().uid,usertype:c},"http://msg.video.qiyi.com/tmpstats.gif")}var c=Math.floor(Math.random()*3+1);$(document).delegate("genbo",function(e){e.target.nodeName&&e.target.nodeName.toUpperCase()=="A"&&$(e.target).attr("href")?d=$(e.target).attr("href"):e.target.parentNode.nodeName&&e.target.parentNode.nodeName.toUpperCase()=="A"&&$(e.target.parentNode).attr("href")&&(d=$(e.target.parentNode).attr("href"));
b("clktrailer");c==2&&(a(),lib.Event.stop(e.event))}.bind(this));var d="",e="genbotrue";lib.component.login.setCallback("login",function(){if(isTrack){if(c==2&&!lib.component.login.isLogin())window.location.href=d;if(lib.component.login.isLogin())b("logsuc"),window.location.href=d+"?seed="+c;isTrack=!1}})});(function(){lib.Class("FloaterNoCoverView",{ns:lib.view,extend:lib.view.FloaterView,methods:{showCover:function(){},hideCover:function(){}}})})();

(function(){lib._PAGE_JOB.add("playCount").add("favourite").add("mark").add("newshare",{weiboName:"\u7231\u5947\u827a\u7535\u89c6\u5267",qqWeiBoName:"\u5947\u827a\u5f71\u89c6"}).add("attention",{qzone:"1833424117",sina:"1832974324",hasanim:"yes",addSinaTpl:'<p class="gzTitle"><span>\u7231\u5947\u827a\u7535\u89c6\u5267</span></p>',addQzoneTpl:'<p class="gzTitle"><span>\u7231\u5947\u827a\u5f71\u89c6</span></p>'}).add("looking10").add("qiyu").add("tvMayLove").add("tvRelative").add("tvIntro").add("ad").add("comment").add("douban").add("commonMoreLess",{moreWrapper:"moreInfo",
lessWrapper:"lessInfo",moreButton:"moreBut",lessButton:"lessBut"}).add("loadtime","tvplay").add("fengyunTabGroups",{pageName:"d2"});lib.$("#j-curr")?lib._PAGE_JOB.add("videolistLazy",{itemTpl:new lib.Template('<li vid="${vid}" pd="${pd}"><a href="${vurl}" title="${vn}" class=""><img width="116" height="65" alt="${vn}" data-lazyLoad="${vpic}_116_65.${vpictype}"><span style="display:none" class="play_txt">\u64ad\u653e\u4e2d..</span><p></p></a><a title="${vn}" href="${vurl}">\u7b2c${pd}\u96c6</a><p class="subtitle" title="${fullvt}">${vt}</p></li>'),
preTpl:new lib.Template('<li vid="${vid}"><a class="imgBg2" href="${vurl}" orinclass="imgBg2"><img width="116" height="65" alt="${vn}" title="${vn}" data-lazyLoad="${vpic}_116_65.${vpictype}" j-delegate="genbo"><span class="txbg" style="display: block; "></span> <span class="text">${psmonth}\u6708${psday}\u65e5 ${pshour}:${psmin}\u66f4\u65b0</span><p></p></a><a href="${vurl}" j-delegate="genbo" title="${vn}" alt="${vn}">${vn}</a></li>'),subTpl:new lib.Template('<li class="play_herald"><div href="#" title="${ps} \u5947\u827a\u5448\u73b0 \u656c\u8bf7\u671f\u5f85" class="imgMore_new"> <div class="em_1"><p>${ps}<br>\u5947\u827a\u5448\u73b0 \u656c\u8bf7\u671f\u5f85</p></div> </div><p class="i_dingyue" style="width:108px;overflow:hidden;"><a style="display: block; " href="#" class="dingyBtn_Bg dingyue1" title="\u8ba2\u9605" onfocus="this.blur();" onclick="return false;" id="ding3">\u66f4\u65b0\u65f6\u901a\u77e5\u6211</a> <a style="display: none; " onclick="return false;" onfocus="this.blur();" title="\u53d6\u6d88\u8ba2\u9605\u6b64\u5267\u96c6" class="dingyBtn_Bg dingyue2" href="#" id="ding4">\u5df2\u8ba2\u9605</a> </p></li>')}):
lib._PAGE_JOB.add("videolist");lib.$("#ding1")&&lib.$("#ding2")&&(lib._PAGE_JOB.add("subscribe",{pageName:"tvPlayFinal"}),lib.$("#flash")&&lib._PAGE_JOB.add("playerSubscribe"));lib._PAGE_EVENT.on("lazylistload",function(){lib.$("#ding3")&&lib.$("#ding4")&&lib._PAGE_JOB.call("subscribe",[{pageName:"tvPlayFinal",subBtnId:"ding3",unsubBtnId:"ding4"}]);lib._PAGE_JOB.start()});lib._PAGE_JOB.add("announceForLogin");lib._PAGE_JOB.start()})();